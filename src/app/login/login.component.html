<div class="flex h-screen">
    <div class="bg-orange-200 hidden md:flex w-full md:w-4 justify-center items-center">
        <img src="/assets/images/auth/signin.svg" class="w-10 mx-auto" alt="" loading="lazy" srcset="">
    </div>
    <div class=" w-full lg:w-8 flex justify-center items-center">
        <div class="surface-card p-8 shadow-2 border-round w-full flex flex-column justify-content-center">
            <div class="w-full md:w-8 mx-auto">
                <!-- <div class="text-center mb-5">
                    <img src="assets/logos/LogoUcacIcamjpg.jpg" alt="UCAC ICAM Logo" height="80" />

                    <div class="text-900 text-3xl font-medium mb-3">Bienvenue chez UCAC-ICAM !</div>
                    <span class="text-600 font-medium">Connectez-vous √† votre compte</span>
                </div> -->

                <div class="mb-5">
                    <div class="text-center">
                        <img src="assets/logos/LogoUcacIcamjpg.jpg" alt="UCAC ICAM Logo" class="mx-auto mb-5" height="80" />
                    </div>
                    
                    <div>
                        <small class="text-600">Ravi de vous revoir ! üëã</small>
                    <p class="text-900 text-xl md:text-3xl font-medium my-0">Connectez-vous √† votre compte</p>
                    </div>
                </div>

                <form [formGroup]="loginForm" (ngSubmit)="login()" class="p-fluid">
                    <div class="field">
                        <label for="email" class="font-medium text-900">Email</label>
                        <input id="email" type="email" pInputText formControlName="username" class="w-full"
                            placeholder="Entrez votre adresse mail" />
                        <small
                            *ngIf="loginForm.get('username')?.invalid && (loginForm.get('username')?.dirty || loginForm.get('username')?.touched)"
                            class="text-red-500">Email is required and must be valid.</small>
                    </div>
                    <div class="field">
                        <label for="password" class="font-medium text-900">Mot de passe</label>
                        <input id="password" type="password" pPassword formControlName="password" class="w-full"
                            placeholder="Entrez votre mot de passe" />
                        <small
                            *ngIf="loginForm.get('password')?.invalid && (loginForm.get('password')?.dirty || loginForm.get('password')?.touched)"
                            class="text-red-500">Password is required.</small>
                    </div>

                    <button pButton pRipple type="submit" label="Connectez-vous" [disabled]="loginForm.invalid"
                        class="w-full mt-3 bg-orange-500 border-orange-500 hover:bg-orange-600 hover:border-orange-600 "></button>
                </form>
                <div class="flex align-items-center justify-content-start mt-3">
                    <a (click)="showModal()" class="font-medium text-orange-500 text-sm cursor-pointer">Mot de passe oubli√© ?</a>
                </div>
            </div>
        </div>
    </div>
</div>

<p-dialog
  [(visible)]="displayModal"
  [closable]="true"
  [modal]="true"
  [style]="{ width: '50vw' }"
  header="R√©initialisation de mot de passe"
  class="rounded-lg shadow-lg"
>
  <ng-container *ngIf="!emailSent">
    <div class="mb-4">
      <label
        for="email"
        class="block text-sm font-medium text-gray-700 mb-1"
      >
        Adresse e-mail
      </label>
      <input
        id="email"
        type="email"
        class="form-control w-full px-4 py-2 border rounded-lg focus:ring-orange-500 focus:border-orange-500 text-sm"
        [(ngModel)]="email"
        (ngModelChange)="validateEmail()"
        [ngClass]="{ 'border-red-500': emailInvalid && emailTouched }"
        placeholder="Entrez votre adresse e-mail"
      />
      <p
        *ngIf="emailInvalid && emailTouched"
        class="text-sm text-red-500 mt-1"
      >
        Adresse e-mail invalide.
      </p>
    </div>

    <div class="mt-3">
      <button
        (click)="sendEmail()"
        [disabled]="emailInvalid"
        class="btn btn-primary w-full bg-orange-500 text-white py-2 px-4 rounded-lg font-medium hover:bg-orange-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition"
      >
        Envoyer
      </button>
    </div>
  </ng-container>

  <ng-container *ngIf="emailSent">
    <div class="text-center">
      <p class="text-gray-700 mb-4">
        Un lien de r√©initialisation du mot de passe a √©t√© envoy√© √†
        <strong>{{ email }}</strong>. Le lien est valide pendant
        <strong>15 minutes</strong>.
      </p>
      <button
        (click)="closeModal()"
        class="btn btn-success mt-2 w-full bg-green-500 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-600 transition"
      >
        OK
      </button>
    </div>
  </ng-container>
</p-dialog>