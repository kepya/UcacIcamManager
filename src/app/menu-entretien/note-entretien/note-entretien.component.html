<section class="note-page page-content">
    <h1 class="page-title"> Entretiens <i class="pi pi-angle-right"></i> Notes entretiens</h1>

    <div class="card">
        <div class="header">
            <h3 class="title">Liste des notes
            </h3>

            <div class="mb-1">
                <p-dropdown [tooltipPosition]="'top'" [options]="zones" [filter]="true" [showClear]="true"
                optionLabel="nom"  [(ngModel)]="zone" [showClear]="true"
                placeholder="Choisir une zone" ></p-dropdown>

                <button pButton pRipple type="button" label="Telecharger les notes"
                class="ml-2 p-button-sm p-button-raised bg-orange-500 border-orange-500"></button>
            </div>
        </div>
        <div class="line"></div>

        <section class="mt-3">
            <p-table #dt1 selectionMode="single" [(selection)]="selectedEntretien" dataKey="candidat" 
                 responsiveLayout="scroll" [value]="entretiens" dataKey="id" [rows]="5"
                [showCurrentPageReport]="true" [rowsPerPageOptions]="[5,10, 25, 50]" [loading]="loading"
                [paginator]="true" currentPageReportTemplate="Présente {first} à {last} de {totalRecords} entrées"
                [globalFilterFields]="['candidat','jury','done',  'centre','debut_entretien']">
                <ng-template pTemplate="caption">
                    <div class="vh-space-between flex justify-content-between ">
                        <div>

                            <h2 class="text-lg font-bold">Note Entretiens</h2>
                            <h4 class="text-orange-500 ">Session de {{session?.date_examen
                                | date:'MMMM':'fr'}}</h4>
                        </div>
                        <div>
                            <button pButton label="Reiniatialiser" class="p-button-outlined mr-2"
                                icon="pi pi-filter-slash" (click)="commonService.clear(dt1)"></button>
                            <span class="ml-2 p-input-icon-left ml-auto">
                                <i class="pi pi-search"></i>
                                <input pInputText type="text"
                                    (input)="dt1.filterGlobal(getEventValue($event), 'contains')"
                                    placeholder="Rechercher" />
                            </span>
                        </div>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th style="min-width:15rem">
                            <div class="flex align-items-center">
                                Candidat
                                <p-columnFilter type="text" field="candidat"
                                    display="menu"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width:15rem">
                            <div class="flex align-items-center">
                                Centre
                                <p-columnFilter type="text" field="centre" display="menu"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width:15rem">
                            <div class="flex align-items-center">
                                Jury 1
                                <p-columnFilter type="text" field="jury" display="menu"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width:10rem">
                            <div class="flex align-items-center">
                                Date
                                <p-columnFilter type="date" field="debut_entretien" display="menu"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width:10rem">
                            <div class="flex align-items-center">
                                Jury 2
                                <p-columnFilter type="date" field="debut_entretien" display="menu"></p-columnFilter>
                            </div>
                        </th>
                        
                        <th style="width:4rem">Note globale
                            <p-columnFilter type="date" field="debut_entretien" display="menu"></p-columnFilter>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-entretien>
                    <tr>
                        <td>
                            {{ entretien.candidat }} 
                        </td>
                        <td>
                            {{ entretien.centre }}
                        </td>
                        <td>
                            {{ entretien.jury1 }}
                        </td>
                        <td>
                            {{ entretien.debut_entretien | date: 'MM/dd/yyyy' }}
                        </td>
                        <td>
                            {{ entretien.jury2 }}
                        </td>
                        <td>
                            <button pButton pRipple type="button" icon="pi pi-times" class="p-button-rounded p-button-danger"></button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="6">Aucun entretien programmé pour le moment.</td>
                    </tr>
                </ng-template>
            </p-table>
        </section>
    </div>
</section>
