"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[468],{9468:(U,C,s)=>{s.r(C),s.d(C,{CalendrierEntretienModule:()=>y});var f=s(9808),D=s(5193),e=s(7587),g=s(8766),Z=s(1303),i=s(7212),u=s(62),c=s(7921),p=s(4036),m=s(2382);function _(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",16),e.NdJ("onChange",function(d){return e.CHM(t),e.oxw().handleInterviewerSelect(d)})("ngModelChange",function(d){return e.CHM(t),e.oxw().interviewer=d}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("options",t.interviewers)("showClear",!0)("ngModel",t.interviewer)}}function v(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){return e.CHM(t),e.oxw().previousDate()}),e._uU(1," Precedent Date "),e.qZA()}}function E(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().prochaineDate()}),e._uU(1," Prochaine Date "),e.qZA()}}function x(n,a){if(1&n&&(e.TgZ(0,"h3",5),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.currentDate))}}function I(n,a){if(1&n&&(e.TgZ(0,"td",20)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit,r=e.oxw();e.uIk("rowspan",r.entretiensBeforeBreak.length+1),e.xp6(2),e.Oqu(t.interviewer)}}function O(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.YNc(11,I,3,2,"td",19),e.qZA()),2&n){const t=a.$implicit,r=a.index;e.xp6(2),e.hij("",e.xi3(3,5,t.disponibility.debut_disponibilite,"H:mm")+" - "+e.xi3(4,8,t.disponibility.fin_disponibilite,"H:mm")," "),e.xp6(4),e.Oqu(t.centre),e.xp6(2),e.Oqu(t.candidat.compte.name),e.xp6(2),e.Oqu(t.candidat.compte.prenom),e.xp6(1),e.Q6J("ngIf",0==r)}}function M(n,a){if(1&n&&(e.TgZ(0,"td",20)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit,r=e.oxw();e.uIk("rowspan",r.entretiensAfterBreak.length+1),e.xp6(2),e.Oqu(t.interviewer)}}function q(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.YNc(11,M,3,2,"td",19),e.qZA()),2&n){const t=a.$implicit,r=a.index;e.xp6(2),e.hij("",e.xi3(3,5,t.disponibility.debut_disponibilite,"H:mm")+" - "+e.xi3(4,8,t.disponibility.fin_disponibilite,"H:mm")," "),e.xp6(4),e.Oqu(t.centre),e.xp6(2),e.Oqu(t.candidat.compte.name),e.xp6(2),e.Oqu(t.candidat.compte.prenom),e.xp6(1),e.Q6J("ngIf",0==r)}}let A=(()=>{class n{constructor(t,r,d,o,l){this.noteService=t,this.storageService=r,this.compteDisponibiliteService=d,this.commonService=o,this.sessionSrv=l,this.interviewers=[],this.entretiensBeforeBreak=[],this.entretiensAfterBreak=[],this.datesOfEntretiens=[],this.indexCurrentDate=0}ngOnInit(){this.currentDate=new Date,this.getActiveSession(),this.compte=this.storageService.getUserConnected(),this.compte.role==D.u.JURY&&(this.interviewer=this.compte.name+" "+this.compte.prenom,this.getEntretiens()),this.getCompteDisponibilite()}getCompteDisponibilite(){this.compteDisponibiliteService.liste().subscribe({next:t=>{var r,d;let o=[];for(let l of t)o.push((null===(r=l.compte)||void 0===r?void 0:r.name)+" "+(null===(d=l.compte)||void 0===d?void 0:d.prenom));this.interviewers=[...new Set(o)]}})}getActiveSession(){this.sessionSrv.getActive().subscribe({next:t=>{let r=new Date(t.date_debut_entretien),d=new Date(t.date_fin_entretien);this.datesOfEntretiens=this.commonService.genererDates(r.getTime(),d.getTime()),this.indexCurrentDate=0,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate]}})}handleInterviewerSelect(t){this.getEntretiens()}getEntretiens(){this.noteService.liste().subscribe({next:t=>{let r=t.filter(o=>{var l,h;return new Date(o.debut_entretien).getDate()===this.currentDate.getDate()&&(null===(l=o.compte)||void 0===l?void 0:l.name)+" "+(null===(h=o.compte)||void 0===h?void 0:h.prenom)===this.interviewer});r.sort((o,l)=>new Date(o.fin_entretien).getTime()-new Date(l.fin_entretien).getTime());let d=r.map(o=>{var l,h,T;return{centre:(null===(l=o.candidature)||void 0===l?void 0:l.centre)||"",interviewer:(null===(h=o.compte)||void 0===h?void 0:h.name)+" "+(null===(T=o.compte)||void 0===T?void 0:T.prenom),candidat:o.candidature,disponibility:{date_disponibilite:o.debut_entretien,debut_disponibilite:new Date(o.debut_entretien),fin_disponibilite:new Date(o.fin_entretien)}}});this.entretiensBeforeBreak=d.filter(o=>o.disponibility.fin_disponibilite.getHours()<=12),this.entretiensAfterBreak=d.filter(o=>o.disponibility.fin_disponibilite.getHours()>12)},error:t=>{console.log("error: ",t)}})}prochaineDate(){this.indexCurrentDate<this.datesOfEntretiens.length&&(this.indexCurrentDate=this.indexCurrentDate>this.datesOfEntretiens.length?this.datesOfEntretiens.length-1:this.indexCurrentDate+1,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate],this.getEntretiens())}previousDate(){this.indexCurrentDate>0&&(this.indexCurrentDate=this.indexCurrentDate<0?0:this.indexCurrentDate-1,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate],this.getEntretiens())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g.Y),e.Y36(Z.V),e.Y36(i.R),e.Y36(u.v),e.Y36(c.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-calendrier-entretien"]],decls:39,vars:6,consts:[[1,"calendrier-entretien-page","calendrier-page","page-content"],[1,"page-title"],[1,"pi","pi-angle-right"],[1,"card"],[1,"header"],[1,"title"],["placeholder","Choisir un intervenant",3,"options","showClear","ngModel","onChange","ngModelChange",4,"ngIf"],["class","btn btn-danger ml-1 mr-1",3,"click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"line"],[1,"sub-header"],["class","title",4,"ngIf"],[1,"calendrier"],["id","table"],[4,"ngFor","ngForOf"],["colspan","4",1,"pause"],["placeholder","Choisir un intervenant",3,"options","showClear","ngModel","onChange","ngModelChange"],[1,"btn","btn-danger","ml-1","mr-1",3,"click"],[1,"btn","btn-primary",3,"click"],["class","rowspan",4,"ngIf"],[1,"rowspan"]],template:function(t,r){1&t&&(e.TgZ(0,"section",0)(1,"h1",1),e._uU(2," Entretiens "),e._UZ(3,"i",2),e._uU(4," Calendrier des entretiens"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"h3",5),e._uU(8,"Calendrier final des entretiens"),e.qZA(),e.TgZ(9,"div"),e.YNc(10,_,1,3,"p-dropdown",6),e.YNc(11,v,2,0,"button",7),e.YNc(12,E,2,0,"button",8),e.qZA()(),e._UZ(13,"div",9),e.TgZ(14,"div",10)(15,"h3",5),e._uU(16,"Entretiens concours Ucac-Icam"),e.qZA(),e.YNc(17,x,3,3,"h3",11),e.qZA(),e.TgZ(18,"div",12)(19,"table",13)(20,"thead")(21,"th"),e._uU(22,"Horaire"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Centre d'examen"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Noms"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Pr\xe9nom"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Intervenants"),e.qZA()(),e.TgZ(31,"tbody"),e.YNc(32,O,12,11,"tr",14),e.TgZ(33,"tr")(34,"td"),e._uU(35,"12h00 - 13h00"),e.qZA(),e.TgZ(36,"td",15),e._uU(37,"Pause"),e.qZA()(),e.YNc(38,q,12,11,"tr",14),e.qZA()()()()()),2&t&&(e.xp6(10),e.Q6J("ngIf","JURY"!=r.compte.role),e.xp6(1),e.Q6J("ngIf",r.datesOfEntretiens.length>1),e.xp6(1),e.Q6J("ngIf",r.datesOfEntretiens.length>1),e.xp6(5),e.Q6J("ngIf",r.currentDate),e.xp6(15),e.Q6J("ngForOf",r.entretiensBeforeBreak),e.xp6(6),e.Q6J("ngForOf",r.entretiensAfterBreak))},directives:[f.O5,p.Lt,m.JJ,m.On,f.sg],pipes:[f.uU],encapsulation:2}),n})();var w=s(7671),b=s(7618);const S=[{path:"",component:A,canActivate:[b.a]},{path:"**",component:A,canActivate:[b.a]}];let J=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[b.a],imports:[[w.Bz.forChild(S)],w.Bz]}),n})(),y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[f.ez,J,m.u5,m.UX,p.kW]]}),n})()},62:(U,C,s)=>{s.d(C,{v:()=>e});var f=s(9808),D=s(7587);let e=(()=>{class g{constructor(){}calculerJours(i,u){var c=Math.abs(u-i);return Math.floor(c/864e5)}clear(i){i.clear()}getStatuses(){return[{label:!1,value:"A faire"},{label:!0,value:"R\xe9alis\xe9"}]}getSeverity(i){switch(i){case!1:return"danger";case!0:return"success";default:return"warning"}}getStatusLabel(i){switch(i){case!1:return"A faire";case!0:return"R\xe9alis\xe9";default:return""}}getFormationLabel(i){return"Ing\xe9nieur g\xe9n\xe9raliste parcours international"==i?"OP":"Ing\xe9nieur g\xe9n\xe9raliste par apprentissage ou g\xe9nie des proc\xe9d\xe9s"==i?"L":"Ing\xe9nieur genie des proc\xe9d\xe9s"==i?"IP":"Ing\xe9nieur g\xe9neraliste parcours international et innovation"==i?"I":"Ing\xe9nieur g\xe9nie Informtique"==i?"X":""}genererDates(i,u){let c=this.calculerJours(i,u);console.log("nombre jour:",c);let p=[],m=new Date(i);p.push(new Date(i));for(let _=0;_<c;_++)m.setDate(m.getDate()+1),p.push(new Date(m));return p}formatDate(i){let c=(0,f.p6)(i,"shortTime","fr-FR").split(":");return c[0]+"h"+c[1]}buildDateWithTime(i){const u=new Date;return new Date(`${u.getFullYear()}-${u.getMonth()+1}-${u.getDate()} ${i}`)}buildDate(i,u){let p,m,c=u.split("-"),v=c[0].split("h");i.setHours(parseInt(v[0],10)+1),i.setMinutes(parseInt(v[1],10)),p=i.getTime();let x=c[1].split("h");return i.setHours(parseInt(x[0],10)+1),i.setMinutes(parseInt(x[1],10)),m=i.getTime(),{startDate:p,endDate:m}}}return g.\u0275fac=function(i){return new(i||g)},g.\u0275prov=D.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()}}]);