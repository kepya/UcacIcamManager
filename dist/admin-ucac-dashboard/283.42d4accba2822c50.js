"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[283],{9169:(z,v,s)=>{s.r(v),s.d(v,{DefineNoteInterviewModule:()=>Y});var f=s(9808),p=s(2382),h=s(7671),e=s(7587),g=s(9783),Z=s(8766),T=s(702),_=s(9930),b=s(845),y=s(1424),I=s(3407),x=s(1208),w=s(7773),N=s(7307);function S(i,a){if(1&i&&(e.TgZ(0,"p",18),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij("Temps d'entretien: ",n.minutesLeft+" min : "+n.secondsLeft+" s","")}}function M(i,a){if(1&i&&(e.TgZ(0,"p",19),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij("Temps additionnel: ",n.minutesLeft+" min : "+n.secondsLeft+" s","")}}const D=function(i,a){return{"p-button-outlined":i,"p-button-success":a}};function A(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){const r=e.CHM(n).$implicit,d=e.oxw().$implicit;return e.oxw().interviewerIsFinish?null:d.note=r}),e.qZA()}if(2&i){const n=a.$implicit,t=e.oxw().$implicit;e.s9C("label",n),e.Q6J("ngClass",e.WLB(2,D,t.note!=n,t.note==n))}}const F=function(i,a){return{"p-button-success":i,"p-button-danger":a}};function E(i,a){if(1&i&&(e.TgZ(0,"div",20),e._UZ(1,"input",21),e.TgZ(2,"div",22),e.YNc(3,A,1,5,"button",23),e.qZA(),e._UZ(4,"button",24),e.qZA()),2&i){const n=a.$implicit,t=e.oxw();e.xp6(1),e.Q6J("readOnly",!0)("disabled",!0)("ngModel","Note "+n.parcours),e.xp6(2),e.Q6J("ngForOf",t.notes),e.xp6(1),e.s9C("icon",n.note>0?"pi pi-check":"pi pi-times"),e.Q6J("ngClass",e.WLB(6,F,n.note>0,0==n.note))}}let C=(()=>{class i{constructor(n,t,o,r,d,c){this.messageService=n,this.noteService=t,this.noteParcoursService=o,this.route=r,this.confirmationService=d,this.candidatService=c,this.totalSeconds=1200,this.minutesLeft=0,this.secondsLeft=0,this.interviewerIsFinish=!1,this.twentyMinuteEnd=!1,this.nombre_choix=0,this.notes=[1,2,3,4],this.hasBourse=!1,this.timeout=!1,this.formationsForFirstCycle=[{name:"Ing\xe9nieur g\xe9n\xe9raliste par apprentissage ou g\xe9nie des proc\xe9d\xe9s",code:"L"},{name:"Ing\xe9nieur g\xe9n\xe9raliste parcours international",code:"OP"},{name:"Ing\xe9nieur g\xe9nie Informatique",code:"X"}],this.formationsForSecondCycle=[{name:"Ing\xe9nieur genie des proc\xe9d\xe9s",code:"IP"},{name:"Ing\xe9nieur g\xe9neraliste parcours international et innovation",code:"I"},{name:"Ing\xe9nieur g\xe9nie Informatique",code:"X"}],this.formations=[]}ngOnInit(){this.route.snapshot.params.idEntretien&&(this.getEntretien(parseInt(this.route.snapshot.params.idEntretien,10)),this.startTimer())}startTimer(){this.intervalId=setInterval(()=>{this.totalSeconds>0?(this.totalSeconds--,this.minutesLeft=Math.floor(this.totalSeconds/60),this.secondsLeft=this.totalSeconds%60):(this.twentyMinuteEnd?(this.interviewerIsFinish=!0,this.validateNotation()):(this.twentyMinuteEnd=!0,this.totalSeconds=300,this.startTimer()),this.stopTimer())},1e3)}stopTimer(){this.intervalId&&clearInterval(this.intervalId)}confirm(n){this.confirmationService.confirm({target:n.target,message:"\xcates vous sures de vouloir continuer ?",icon:"pi pi-question",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>{this.validateNotation()},reject:()=>{this.messageService.add({severity:"error",summary:"Non",detail:"vous avez annul\xe9 la suppresion"})}})}addNote(){this.timeout=!0;for(let n=0;n<this.formations.length;n++){let t=this.formations[n];t.note=0==t.note?4:t.note,this.noteParcoursService.create(t).subscribe({next:o=>{this.messageService.add({severity:"success",summary:"Assignation de note",detail:"Assignation de note effectu\xe9e avec success"})},error:o=>{this.messageService.add({severity:"error",summary:"Erreur d'assignation",detail:o.error.message}),console.log("error: ",o)}})}this.updateNote(),this.updateCandidatAccount()}updateNote(){var n;this.noteService.update({id:(null===(n=this.note)||void 0===n?void 0:n.id)||0,compteid:this.note.compteid,candidatureid:this.note.candidatureid,debut_entretien:this.note.debut_entretien,fin_entretien:this.note.fin_entretien,commentaires:this.comment,noteL:0,noteOP:0,noteX:0,juryid:0}).subscribe({next:t=>{this.messageService.add({severity:"success",summary:"Mise \xe0 jour des notes",detail:"Mise \xe0 jour des notes effectu\xe9e avec success"})},error:t=>{this.messageService.add({severity:"error",summary:"Erreur d'assignation",detail:t.error.message}),console.log("error: ",t)}})}validateNotation(){if(this.interviewerIsFinish)this.addNote();else{let n=!1;for(let t=0;t<this.formations.length;t++)0==this.formations[t].note&&(n=!0);n?this.messageService.add({severity:"error",summary:"Note manquant",detail:"Veuillez selectionner les notes pour chaque formation."}):this.addNote()}}getFormation(n,t){return 0==n?t.formation1:1==n?t.formation2:3==n?t.formation3:""}updateCandidatAccount(){var n;if(this.hasBourse){let t=this.entretien.candidature;t.has_exchange=!0,t.compteID=(null===(n=null==t?void 0:t.compte)||void 0===n?void 0:n.id)||0,this.candidatService.update(t.id||0,t).subscribe({next:o=>{this.messageService.add({severity:"success",summary:"Modification de compte candidat",detail:"Modification effectu\xe9e avec success"})},error:o=>{this.messageService.add({severity:"error",summary:"Erreur de creation",detail:o.error})}})}}getEntretien(n){this.noteService.getOne(n).subscribe({next:t=>{var o,r,d,c,u,l;this.note=t,this.hasBourse=t.candidature.has_exchange||!1,this.nombre_choix=t.candidature.nombre_choix;for(let m=0;m<t.candidature.nombre_choix;m++)this.formations.push({cycle:t.candidature.cycle,id:0,note:0,noteId:n,parcours:this.getFormation(m,t.candidature)});this.entretien={id:null!==(o=t.id)&&void 0!==o?o:0,candidat:(null===(r=t.candidature.compte)||void 0===r?void 0:r.name)+" "+(null===(d=t.candidature.compte)||void 0===d?void 0:d.prenom),commentaires:t.commentaires,done:t.done,cycle:t.candidature.cycle.toString(),centre:(null===(c=t.candidature)||void 0===c?void 0:c.centre)||"",jury:(null===(u=t.compte)||void 0===u?void 0:u.name)+" "+(null===(l=t.compte)||void 0===l?void 0:l.prenom),candidature:t.candidature,debut_entretien:new Date(t.debut_entretien),fin_entretien:new Date(t.fin_entretien)}},error:t=>{console.log("error: ",t)}})}getEntretiens(){this.noteService.liste().subscribe({next:n=>{n.map(o=>{var r,d,c,u,l,m;return{id:null!==(r=o.id)&&void 0!==r?r:0,candidat:(null===(d=o.candidature.compte)||void 0===d?void 0:d.name)+" "+(null===(c=o.candidature.compte)||void 0===c?void 0:c.prenom),commentaires:o.commentaires,done:o.done,cycle:o.candidature.cycle.toString(),centre:(null===(u=o.candidature)||void 0===u?void 0:u.centre)||"",jury:(null===(l=o.compte)||void 0===l?void 0:l.name)+" "+(null===(m=o.compte)||void 0===m?void 0:m.prenom),candidature:o.candidature,debut_entretien:new Date(o.debut_entretien),fin_entretien:new Date(o.fin_entretien)}})},error:n=>{console.log("error: ",n)}})}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(g.ez),e.Y36(Z.Y),e.Y36(T.k),e.Y36(h.gz),e.Y36(g.YP),e.Y36(_.u))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-define-note-interview"]],decls:29,vars:12,consts:[[1,"define_note_interview_page","page-content","flex","justify-content-between","flex-column"],[1,"flex-wrap","vh-space-between","mt-2"],["pButton","","pRipple","","type","button","label","Evalution des Candidats",1,"p-button-sm","p-button-raised","p-button-secondary"],["class","text-red-500 font-bold",4,"ngIf"],["class","text-red-500 font-bold blink_me",4,"ngIf"],[1,"flex-wrap","vh-space-between","mt-4"],[1,"vh-center"],[1,"mr-4"],[1,"font-medium","capitalize"],[1,"mt-4"],["class","flex-wrap vh-space-between mb-4",4,"ngFor","ngForOf"],[1,"mb-4"],["placeholder","Ajoutez un commentaire","pInputTextarea","",1,"w-full",3,"ngModel","rows","autoResize","disabled","ngModelChange"],[1,"field-checkbox"],["inputId","binary",3,"ngModel","binary","ngModelChange"],["for","binary"],[1,"vh-end"],["pButton","","pRipple","","type","button","label","Valider",1,"p-button-sm","p-button-raised","p-button-success",3,"disabled","click"],[1,"text-red-500","font-bold"],[1,"text-red-500","font-bold","blink_me"],[1,"flex-wrap","vh-space-between","mb-4"],["type","text","pInputText","",3,"readOnly","disabled","ngModel"],[1,"flex","gap-2"],["pButton","","pRipple","","type","button","class","p-button-sm p-button-raised p-button-rounded",3,"label","ngClass","click",4,"ngFor","ngForOf"],["pButton","","pRipple","","type","button",1,"p-button-sm","p-button-raised","p-button-rounded",3,"icon","ngClass"],["pButton","","pRipple","","type","button",1,"p-button-sm","p-button-raised","p-button-rounded",3,"label","ngClass","click"]],template:function(n,t){if(1&n&&(e.TgZ(0,"section",0)(1,"div")(2,"div",1),e._UZ(3,"button",2),e.YNc(4,S,2,1,"p",3),e.YNc(5,M,2,1,"p",4),e.qZA(),e.TgZ(6,"div",5)(7,"div",6)(8,"h1",7),e._uU(9,"Entretien de : "),e.qZA(),e.TgZ(10,"h3",8),e._uU(11),e.qZA()(),e.TgZ(12,"div",6)(13,"h3",7),e._uU(14,"Cycle : "),e.qZA(),e.TgZ(15,"h3",8),e._uU(16),e.qZA()()(),e.TgZ(17,"div",9),e.YNc(18,E,5,9,"div",10),e.qZA(),e.TgZ(19,"div",11)(20,"textarea",12),e.NdJ("ngModelChange",function(r){return t.comment=r}),e.qZA(),e.TgZ(21,"div",13)(22,"p-checkbox",14),e.NdJ("ngModelChange",function(r){return t.hasBourse=r}),e.qZA(),e.TgZ(23,"label",15),e._uU(24,"Ce candidat a souscrit \xe0 une bourse"),e.qZA()()()(),e.TgZ(25,"div",16)(26,"button",17),e.NdJ("click",function(r){return t.confirm(r)}),e.qZA()()(),e._UZ(27,"p-toast")(28,"p-confirmPopup")),2&n){let o,r;e.xp6(4),e.Q6J("ngIf",!t.twentyMinuteEnd),e.xp6(1),e.Q6J("ngIf",t.twentyMinuteEnd),e.xp6(6),e.Oqu(null!==(o=null==t.entretien?null:t.entretien.candidat)&&void 0!==o?o:""),e.xp6(5),e.Oqu(null!==(r=null==t.entretien?null:t.entretien.cycle)&&void 0!==r?r:""),e.xp6(2),e.Q6J("ngForOf",t.formations),e.xp6(2),e.Q6J("ngModel",t.comment)("rows",10)("autoResize",!0)("disabled",t.interviewerIsFinish),e.xp6(2),e.Q6J("ngModel",t.hasBourse)("binary",!0),e.xp6(4),e.Q6J("disabled",t.interviewerIsFinish)}},directives:[b.Hq,f.O5,f.sg,p.Fj,y.o,p.JJ,p.On,f.mk,I.g,x.XZ,w.FN,N.P],encapsulation:2}),i})();const J=[{path:"",component:C},{path:":idEntretien",component:C}];let B=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[h.Bz.forChild(J)],h.Bz]}),i})();var j=s(9142),O=s(4036),L=s(4255),U=s(5315);let Y=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[f.ez,B,p.u5,p.UX,w.EV,N.n,b.hJ,j.W,O.kW,L.U$,y.j,U.S,I.A,x.nD]]}),i})()}}]);