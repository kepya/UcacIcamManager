"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[169],{9169:(N,_,a)=>{a.r(_),a.d(_,{DefineNoteInterviewModule:()=>U});var b=a(9808),y=a(2382),x=a(7671),e=a(7587),S=a(9783),r=a(8766),d=a(702),l=a(62),p=a(9930),f=a(845),g=a(1424),I=a(3407),C=a(1208),D=a(7773),M=a(7307);function Z(o,c){if(1&o&&(e.TgZ(0,"p",18),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.hij("Temps d'entretien: ",n.minutesLeft+" min : "+n.secondsLeft+" s","")}}function A(o,c){if(1&o&&(e.TgZ(0,"p",19),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.hij("Temps additionnel: ",n.minutesLeft+" min : "+n.secondsLeft+" s","")}}const F=function(o,c){return{"p-button-outlined":o,"p-button-success":c}};function E(o,c){if(1&o){const n=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){const s=e.CHM(n).$implicit,u=e.oxw().$implicit;return e.oxw().interviewerIsFinish?null:u.note=s}),e.qZA()}if(2&o){const n=c.$implicit,t=e.oxw().$implicit;e.s9C("label",n),e.Q6J("ngClass",e.WLB(2,F,t.note!=n,t.note==n))}}const J=function(o,c){return{"p-button-success":o,"p-button-danger":c}};function j(o,c){if(1&o&&(e.TgZ(0,"div",20),e._UZ(1,"input",21),e.TgZ(2,"div",22),e.YNc(3,E,1,5,"button",23),e.qZA(),e._UZ(4,"button",24),e.qZA()),2&o){const n=c.$implicit,t=e.oxw();e.xp6(1),e.Q6J("readOnly",!0)("disabled",!0)("ngModel","Note "+n.parcours),e.xp6(2),e.Q6J("ngForOf",t.notes),e.xp6(1),e.s9C("icon",n.note>0?"pi pi-check":"pi pi-times"),e.Q6J("ngClass",e.WLB(6,J,n.note>0,0==n.note))}}let T=(()=>{class o{constructor(n,t,i,s,u,m,v,h){this.messageService=n,this.noteService=t,this.location=i,this.noteParcoursService=s,this.route=u,this.commonService=m,this.confirmationService=v,this.candidatService=h,this.totalSeconds=1200,this.minutesLeft=0,this.secondsLeft=0,this.interviewerIsFinish=!1,this.twentyMinuteEnd=!1,this.nombre_choix=0,this.notes=[1,2,3,4],this.hasBourse=!1,this.noteIsAlreadyValidated=!1,this.timeout=!1,this.formationsForFirstCycle=[{name:"Ing\xe9nieur g\xe9n\xe9raliste par apprentissage ou g\xe9nie des proc\xe9d\xe9s",code:"L"},{name:"Ing\xe9nieur g\xe9n\xe9raliste parcours international",code:"OP"},{name:"Ing\xe9nieur g\xe9nie Informatique",code:"X"}],this.formationsForSecondCycle=[{name:"Ing\xe9nieur genie des proc\xe9d\xe9s",code:"IP"},{name:"Ing\xe9nieur g\xe9neraliste parcours international et innovation",code:"I"},{name:"Ing\xe9nieur g\xe9nie Informatique",code:"X"}],this.formations=[]}ngOnInit(){this.route.snapshot.params.idEntretien&&(this.getEntretien(parseInt(this.route.snapshot.params.idEntretien,10)),this.startTimer())}startTimer(){this.intervalId=setInterval(()=>{this.totalSeconds>0?(this.totalSeconds--,this.minutesLeft=Math.floor(this.totalSeconds/60),this.secondsLeft=this.totalSeconds%60,5==this.minutesLeft&&0==this.secondsLeft&&this.messageService.add({severity:"warning",summary:"5 min restantes",detail:"Il vous reste 5 min r\xe9glementaires pour finaliser avec cet entretien."})):(this.twentyMinuteEnd?(this.interviewerIsFinish=!0,this.validateNotation()):(this.messageService.add({severity:"info",summary:"5 min additionnelles",detail:"Vous avez 5 min additionnelles pour finaliser avec cet entretien."}),this.twentyMinuteEnd=!0,this.totalSeconds=300,this.startTimer()),this.stopTimer())},1e3)}stopTimer(){this.intervalId&&clearInterval(this.intervalId)}confirm(n){this.confirmationService.confirm({target:n.target,message:"\xcates-vous s\xfbr de vouloir continuer ?",icon:"pi pi-question",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>{this.validateNotation()},reject:()=>{this.messageService.add({severity:"error",summary:"Non",detail:"vous avez annul\xe9 la suppresion"})}})}addNote(){this.timeout=!0;let n=0;for(let t=0;t<this.formations.length;t++){let i=this.formations[t];i.note=0==i.note?4:i.note,this.noteParcoursService.create(i).subscribe({next:s=>{n+=1,this.noteIsAlreadyValidated=!0,this.messageService.add({severity:"success",summary:"Assignation de note",detail:"Assignation de note effectu\xe9e avec success"})},error:s=>{this.messageService.add({severity:"error",summary:"Erreur d'assignation",detail:s.error.message}),console.log("error: ",s)}})}this.updateNote(),this.updateCandidatAccount(),n>=this.formations.length&&this.location.back()}updateNote(){var n,t,i,s,u;this.noteService.update({id:(null===(n=this.note)||void 0===n?void 0:n.id)||0,compteid:null===(t=this.note)||void 0===t?void 0:t.compteid,candidatureid:null===(i=this.note)||void 0===i?void 0:i.candidatureid,debut_entretien:null===(s=this.note)||void 0===s?void 0:s.debut_entretien,fin_entretien:null===(u=this.note)||void 0===u?void 0:u.fin_entretien,commentaires:this.comment,noteL:0,noteOP:0,noteX:0,juryid:0}).subscribe({next:m=>{this.messageService.add({severity:"success",summary:"Mise \xe0 jour des notes",detail:"Mise \xe0 jour des notes effectu\xe9e avec success"})},error:m=>{this.messageService.add({severity:"error",summary:"Erreur d'assignation",detail:m.error.message}),console.log("error: ",m)}})}validateNotation(){if(this.interviewerIsFinish)this.noteIsAlreadyValidated?this.messageService.add({severity:"error",summary:"Notes d\xe9j\xe0 d\xe9finies",detail:"Vous avez d\xe9j\xe0 entr\xe9 les notes de ce candidat."}):this.addNote();else{let n=!1;for(let t=0;t<this.formations.length;t++)0==this.formations[t].note&&(n=!0);n?this.messageService.add({severity:"error",summary:"Note manquant",detail:"Veuillez selectionner les notes pour chaque formation."}):this.noteIsAlreadyValidated?this.messageService.add({severity:"error",summary:"Notes d\xe9j\xe0 d\xe9finies",detail:"Vous avez d\xe9j\xe0 entr\xe9 les notes de ce candidat."}):this.addNote()}}getFormation(n,t){return 0==n?t.formation1:1==n?t.formation2:3==n?t.formation3:""}updateCandidatAccount(){var n;if(this.hasBourse){let t=this.entretien.candidature;t.has_exchange=!0,t.compteID=(null===(n=null==t?void 0:t.compte)||void 0===n?void 0:n.id)||0,this.candidatService.update(t.id||0,t).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"Modification de compte candidat",detail:"Modification effectu\xe9e avec success"})},error:i=>{this.messageService.add({severity:"error",summary:"Erreur de creation",detail:i.error})}})}}getEntretien(n){this.noteService.getOne(n).subscribe({next:t=>{var i,s,u,m,v,h;this.note=t,this.hasBourse=t.candidature.has_exchange||!1,this.nombre_choix=t.candidature.nombre_choix;for(let w=0;w<t.candidature.nombre_choix;w++)this.formations.push({cycle:t.candidature.cycle,id:0,note:0,noteId:n,parcours:this.getFormation(w,t.candidature)});this.entretien={id:null!==(i=t.id)&&void 0!==i?i:0,candidat:(null===(s=t.candidature.compte)||void 0===s?void 0:s.name)+" "+(null===(u=t.candidature.compte)||void 0===u?void 0:u.prenom),commentaires:t.commentaires,done:t.done,cycle:t.candidature.cycle.toString(),centre:(null===(m=t.candidature)||void 0===m?void 0:m.centre)||"",jury:(null===(v=t.compte)||void 0===v?void 0:v.name)+" "+(null===(h=t.compte)||void 0===h?void 0:h.prenom),candidature:t.candidature,debut_entretien:new Date(t.debut_entretien),fin_entretien:new Date(t.fin_entretien)}},error:t=>{console.log("error: ",t)}})}getEntretiens(){this.noteService.liste().subscribe({next:n=>{n.map(i=>{var s,u,m,v,h,w;return{id:null!==(s=i.id)&&void 0!==s?s:0,candidat:(null===(u=i.candidature.compte)||void 0===u?void 0:u.name)+" "+(null===(m=i.candidature.compte)||void 0===m?void 0:m.prenom),commentaires:i.commentaires,done:i.done,cycle:i.candidature.cycle.toString(),centre:(null===(v=i.candidature)||void 0===v?void 0:v.centre)||"",jury:(null===(h=i.compte)||void 0===h?void 0:h.name)+" "+(null===(w=i.compte)||void 0===w?void 0:w.prenom),candidature:i.candidature,debut_entretien:this.commonService.formatDate1(new Date(i.debut_entretien)),fin_entretien:this.commonService.formatDate1(new Date(i.fin_entretien))}})},error:n=>{console.log("error: ",n)}})}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(S.ez),e.Y36(r.Y),e.Y36(b.Ye),e.Y36(d.k),e.Y36(x.gz),e.Y36(l.v),e.Y36(S.YP),e.Y36(p.u))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-define-note-interview"]],decls:29,vars:12,consts:[[1,"define_note_interview_page","page-content","flex","justify-content-between","flex-column"],[1,"flex-wrap","vh-space-between","mt-2"],["pButton","","pRipple","","type","button","label","Evaluation des Candidats",1,"p-button-sm","p-button-raised","p-button-secondary"],["class","text-red-500 font-bold",4,"ngIf"],["class","text-red-500 font-bold blink_me",4,"ngIf"],[1,"flex-wrap","vh-space-between","mt-4"],[1,"vh-center"],[1,"mr-4"],[1,"font-medium","capitalize"],[1,"mt-4"],["class","flex-wrap vh-space-between mb-4",4,"ngFor","ngForOf"],[1,"mb-4"],["placeholder","Ajoutez un commentaire","pInputTextarea","",1,"w-full",3,"ngModel","rows","autoResize","disabled","ngModelChange"],[1,"field-checkbox"],["inputId","binary",3,"ngModel","binary","ngModelChange"],["for","binary"],[1,"vh-end"],["pButton","","pRipple","","type","button","label","Valider",1,"p-button-sm","p-button-raised","p-button-success",3,"disabled","click"],[1,"text-red-500","font-bold"],[1,"text-red-500","font-bold","blink_me"],[1,"flex-wrap","vh-space-between","mb-4"],["type","text","pInputText","",3,"readOnly","disabled","ngModel"],[1,"flex","gap-2"],["pButton","","pRipple","","type","button","class","p-button-sm p-button-raised p-button-rounded",3,"label","ngClass","click",4,"ngFor","ngForOf"],["pButton","","pRipple","","type","button",1,"p-button-sm","p-button-raised","p-button-rounded",3,"icon","ngClass"],["pButton","","pRipple","","type","button",1,"p-button-sm","p-button-raised","p-button-rounded",3,"label","ngClass","click"]],template:function(n,t){if(1&n&&(e.TgZ(0,"section",0)(1,"div")(2,"div",1),e._UZ(3,"button",2),e.YNc(4,Z,2,1,"p",3),e.YNc(5,A,2,1,"p",4),e.qZA(),e.TgZ(6,"div",5)(7,"div",6)(8,"h1",7),e._uU(9,"Entretien de : "),e.qZA(),e.TgZ(10,"h3",8),e._uU(11),e.qZA()(),e.TgZ(12,"div",6)(13,"h3",7),e._uU(14,"Cycle : "),e.qZA(),e.TgZ(15,"h3",8),e._uU(16),e.qZA()()(),e.TgZ(17,"div",9),e.YNc(18,j,5,9,"div",10),e.qZA(),e.TgZ(19,"div",11)(20,"textarea",12),e.NdJ("ngModelChange",function(s){return t.comment=s}),e.qZA(),e.TgZ(21,"div",13)(22,"p-checkbox",14),e.NdJ("ngModelChange",function(s){return t.hasBourse=s}),e.qZA(),e.TgZ(23,"label",15),e._uU(24,"Ce candidat a souscrit \xe0 une bourse"),e.qZA()()()(),e.TgZ(25,"div",16)(26,"button",17),e.NdJ("click",function(s){return t.confirm(s)}),e.qZA()()(),e._UZ(27,"p-toast")(28,"p-confirmPopup")),2&n){let i,s;e.xp6(4),e.Q6J("ngIf",!t.twentyMinuteEnd),e.xp6(1),e.Q6J("ngIf",t.twentyMinuteEnd),e.xp6(6),e.Oqu(null!==(i=null==t.entretien?null:t.entretien.candidat)&&void 0!==i?i:""),e.xp6(5),e.Oqu(null!==(s=null==t.entretien?null:t.entretien.cycle)&&void 0!==s?s:""),e.xp6(2),e.Q6J("ngForOf",t.formations),e.xp6(2),e.Q6J("ngModel",t.comment)("rows",10)("autoResize",!0)("disabled",t.interviewerIsFinish),e.xp6(2),e.Q6J("ngModel",t.hasBourse)("binary",!0),e.xp6(4),e.Q6J("disabled",t.interviewerIsFinish)}},directives:[f.Hq,b.O5,b.sg,y.Fj,g.o,y.JJ,y.On,b.mk,I.g,C.XZ,D.FN,M.P],encapsulation:2}),o})();const L=[{path:"",component:T},{path:":idEntretien",component:T}];let O=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[x.Bz.forChild(L)],x.Bz]}),o})();var B=a(9142),Y=a(4036),z=a(4255),R=a(5315);let U=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[b.ez,O,y.u5,y.UX,D.EV,M.n,f.hJ,B.W,Y.kW,z.U$,g.j,R.S,I.A,C.nD]]}),o})()},62:(N,_,a)=>{a.d(_,{v:()=>x});var b=a(9808),y=a(7587);let x=(()=>{class e{constructor(){}calculerJours(r,d){var l=Math.abs(d-r);return Math.floor(l/864e5)}clear(r){r.clear()}getStatuses(){return[{label:!1,value:"A faire"},{label:!0,value:"R\xe9alis\xe9"}]}getSeverity(r){switch(r){case!1:return"danger";case!0:return"success";default:return"warning"}}getStatusLabel(r){switch(r){case!1:return"A faire";case!0:return"R\xe9alis\xe9";default:return""}}getFormationLabel(r){return"Ing\xe9nieur g\xe9n\xe9raliste parcours international"==r?"OP":"Ing\xe9nieur g\xe9n\xe9raliste par apprentissage ou g\xe9nie des proc\xe9d\xe9s"==r?"L":"Ing\xe9nieur genie des proc\xe9d\xe9s"==r?"IP":"Ing\xe9nieur g\xe9neraliste parcours international et innovation"==r?"I":"Ing\xe9nieur g\xe9nie Informtique"==r?"X":""}genererDates(r,d){let l=this.calculerJours(r,d);console.log("nombre jour:",l);let p=[],f=new Date(r);p.push(new Date(r));for(let g=0;g<l;g++)f.setDate(f.getDate()+1),p.push(new Date(f));return p}formatDate(r){let l=(0,b.p6)(r,"shortTime","fr-FR").split(":");return parseInt(l[0],10)-1+"h"+l[1]}formatDate1(r){const d=new Date(r),g=(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours()),I=d.getMinutes();return d.setHours(g-1),d.setMinutes(I),d}buildDateWithTime(r){const d=new Date;return new Date(`${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()} ${r}`)}buildDate(r,d){let p,f,l=d.split("-"),I=l[0].split("h");r.setHours(parseInt(I[0],10)+1),r.setMinutes(parseInt(I[1],10)),p=r.getTime();let D=l[1].split("h");return r.setHours(parseInt(D[0],10)+1),r.setMinutes(parseInt(D[1],10)),f=r.getTime(),{startDate:p,endDate:f}}}return e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=y.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);