"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[444],{5444:(L,x,r)=>{r.r(x),r.d(x,{IntervenantEntretienModule:()=>z});var Z=r(2382),g=r(9808),_=r(5193);r(7231);const A=[{date:new Date("2023-03-23"),time:"8H30-12H00",interviewer:["DIANA MENGUELE","AUBIN FOSSOUO"]},{date:new Date("2023-03-23"),time:"13H00-16H30",interviewer:["AUBIN FOSSOUO"]},{time:"8H30-12H00",date:new Date("2023-03-24"),interviewer:["DIANA MENGUELE"]},{time:"13H00-16H30",date:new Date("2023-03-24"),interviewer:["AUBIN FOSSOUO"]},{time:"8H30-12H00",date:new Date("2023-03-25"),interviewer:["AUBIN FOSSOUO"]},{time:"13H00-16H30",date:new Date("2023-03-25"),interviewer:["DIANA MENGUELE"]},{date:new Date("2023-03-26"),time:"8H30-12H00",interviewer:["DIANA MENGUELE","AUBIN FOSSOUO"]},{date:new Date("2023-03-26"),time:"13H00-16H30",interviewer:["DIANA MENGUELE"]}];var e=r(7587),D=r(3322),I=r(7921),y=r(9099),S=r(62),M=r(3270),N=r(7212),b=r(7671),T=r(9783),C=r(6526);function U(t,l){if(1&t&&(e.TgZ(0,"th"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&t){const i=l.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,i))}}function w(t,l){if(1&t){const i=e.EpF();e.TgZ(0,"div",16)(1,"p-multiSelect",17),e.NdJ("onChange",function(s){e.CHM(i);const o=e.oxw().$implicit,a=e.oxw().$implicit;return e.oxw(2).selectJury(s,a,o)}),e.qZA(),e.TgZ(2,"button",18),e.NdJ("click",function(s){e.CHM(i);const o=e.oxw().$implicit,a=e.oxw(),c=a.$implicit,d=a.index;return e.oxw(2).validerJury(s,c,o,d)}),e._uU(3," Valider "),e.qZA()()}if(2&t){const i=e.oxw(2).index,n=e.oxw(2);e.xp6(1),e.Q6J("options",n.juries)("disabled",n.disabledMap.get(i)||!1)}}function O(t,l){if(1&t){const i=e.EpF();e.TgZ(0,"input",19),e.NdJ("change",function(s){e.CHM(i);const o=e.oxw().$implicit,a=e.oxw(),c=a.$implicit,d=a.index;return e.oxw(2).validerJury(s,c,o,d)}),e.qZA()}if(2&t){const i=e.oxw(2).index;e.MGl("id","checkbox",i,"")}}function F(t,l){if(1&t&&(e.TgZ(0,"td"),e.YNc(1,w,4,2,"div",14),e.YNc(2,O,1,1,"input",15),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Q6J("ngIf","ADMIN"==i.userConnected.role),e.xp6(1),e.Q6J("ngIf","ADMIN"!=i.userConnected.role)}}function H(t,l){if(1&t&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.YNc(3,F,3,2,"td",13),e.qZA()),2&t){const i=l.$implicit,n=e.oxw(2);e.xp6(2),e.hij("",i," "),e.xp6(1),e.Q6J("ngForOf",n.datesOfDisponibilities)}}function J(t,l){if(1&t&&(e.TgZ(0,"table",12)(1,"thead")(2,"th"),e._uU(3,"Horaire"),e.qZA(),e.YNc(4,U,3,3,"th",13),e.qZA(),e.TgZ(5,"tbody"),e.YNc(6,H,4,2,"tr",13),e.qZA()()),2&t){const i=e.oxw();e.xp6(4),e.Q6J("ngForOf",i.datesOfDisponibilities),e.xp6(2),e.Q6J("ngForOf",i.horaires)}}let j=(()=>{class t{constructor(i,n,s,o,a,c,d,p){this.disponibilitySrv=i,this.sessionSrv=n,this.compteSrv=s,this.commonService=o,this.storageService=a,this.compteDisponibiliteService=c,this.router=d,this.messageService=p,this.disponibilities=[],this.datesOfDisponibilities=[],this.horaires=[],this.juries=[],this.i=0,this.selectDisponibilities=[]}ngOnInit(){this.disponibilityMap=new Map,this.disabledMap=new Map,this.juriesByDispo=new Map,this.getActiveSession(),this.userConnected=this.storageService.getUserConnected(),this.userConnected.role==_.u.ADMIN&&this.getJuryComptes(),this.getDisponibilities()}getActiveSession(){this.sessionSrv.getActive().subscribe({next:i=>{this.session=i}})}getJuryComptes(){this.compteSrv.findByRole(_.u.JURY).subscribe({next:i=>{this.juries=i},error:i=>{console.log("error: ",i)}})}getDisponibilities(){this.disponibilitySrv.liste().subscribe({next:i=>{this.disponibilities=i;let n=[];for(let o=0;o<this.disponibilities.length;o++){const a=this.disponibilities[o];let c=new Date(a.date_disponibilite).getTime();n.includes(c)||n.push(c);let v=this.commonService.formatDate(a.debut_disponibilite)+" - "+this.commonService.formatDate(a.fin_disponibilite);this.horaires.includes(v)||this.horaires.push(v),this.disponibilityMap.set(v+" - "+c,a.id||0)}console.log("horaires: ",A);let s=new Set(n);this.datesOfDisponibilities=[...s],this.datesOfDisponibilities.sort()},error:i=>{}})}enregistrerLesHoraires(){let i=0;for(let n=0;n<this.selectDisponibilities.length;n++){const s=this.selectDisponibilities[n];this.compteDisponibiliteService.create({disponibilite_id:s.disponibilityId,compteId:s.jury}).subscribe({next:o=>{this.messageService.add({severity:"success",summary:"Selection de la plage",detail:"Selection de la plage \xe9ffectu\xe9e avec success"}),i+=1},error:o=>{console.log("Error: ",o),this.messageService.add({severity:"error",summary:"Erreur de s\xe9lection de la plage",detail:o.message})}})}i>=this.selectDisponibilities.length&&this.router.navigate(["calendrier_entretiens"])}selectJury(i,n,s){this.juriesByDispo.set(n+" - "+s,i.value)}validerJury(i,n,s,o){let a=this.disponibilityMap.get(n+" - "+s);if(this.userConnected.role==_.u.ADMIN){let c=this.juriesByDispo.get(n+" - "+s)||[];for(let d=0;d<c.length;d++)this.selectDisponibilities.push({disponibilityId:a,selectId:o,jury:c[d].id||0});this.disabledMap.set(o,!0)}else{let c={disponibilityId:a,selectId:o,jury:this.userConnected.id||0};if(i.target.checked)this.selectDisponibilities.push(c);else{let d=this.selectDisponibilities.findIndex(p=>p.jury==this.userConnected.id);d>-1&&this.selectDisponibilities.splice(d,1)}}}reset(){window.location.reload()}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(D.T),e.Y36(I.K),e.Y36(y.D),e.Y36(S.v),e.Y36(M.V),e.Y36(N.R),e.Y36(b.F0),e.Y36(T.ez))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-intervenant-entretien"]],decls:21,vars:1,consts:[[1,"calendrier-disponibilite-page","calendrier-page","page-content"],[1,"page-title"],[1,"pi","pi-angle-right"],[1,"card"],[1,"header"],[1,"title"],[1,"line"],[1,"calendrier"],["id","table",4,"ngIf"],[1,"footer"],[1,"btn-group"],["type","button",1,"btn","btn-info",3,"click"],["id","table"],[4,"ngFor","ngForOf"],["class","v-center",4,"ngIf"],["type","checkbox",3,"id","change",4,"ngIf"],[1,"v-center"],["defaultLabel","Selectionner des membres","optionLabel","name","display","chip",3,"options","disabled","onChange"],["type","button",1,"ml-2","btn","btn-info",3,"click"],["type","checkbox",3,"id","change"]],template:function(i,n){1&i&&(e.TgZ(0,"section",0)(1,"h1",1),e._uU(2," Entretiens "),e._UZ(3,"i",2),e._uU(4," Horaire de disponibilit\xe9s"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"h3",5),e._uU(8,"Veuillez selectionner vos horaires "),e.qZA(),e.TgZ(9,"p"),e._uU(10,"Au niveau de cette page vous avez la liste des jours d'entretiens et les quart times de disponibilit\xe9. Veuillez selectionner le quart time auquel vous serez disponible ces diff\xe9rents jours."),e.qZA()(),e._UZ(11,"div",6),e.TgZ(12,"div",7),e.YNc(13,J,7,2,"table",8),e.TgZ(14,"section"),e._uU(15," Veuillez definir des p\xe9riodes de disponibilit\xe9s afin de selectionner les horaires qui vous interessent "),e.qZA()(),e.TgZ(16,"div",9),e._UZ(17,"div",6),e.TgZ(18,"div",10)(19,"button",11),e.NdJ("click",function(){return n.enregistrerLesHoraires()}),e._uU(20," Soumettre "),e.qZA()()()()()),2&i&&(e.xp6(13),e.Q6J("ngIf",n.datesOfDisponibilities.length>0))},directives:[g.O5,g.sg,C.NU],pipes:[g.uU],encapsulation:2}),t})();var E=r(7618);const Y=[{path:"",component:j,canActivate:[E.a]}];let B=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[E.a],imports:[[b.Bz.forChild(Y)],b.Bz]}),t})(),z=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[g.ez,B,Z.u5,Z.UX,C.q4]]}),t})()}}]);