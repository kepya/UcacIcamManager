"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[85],{1085:(w,g,l)=>{l.r(g),l.d(g,{IntervenantEntretienModule:()=>O});var b=l(2382),h=l(9808),v=l(5193),e=l(7587),x=l(3322),y=l(7921),I=l(9099),Z=l(62),C=l(1303),D=l(7212),m=l(7671),E=l(9783),_=l(6526);function T(i,a){if(1&i&&(e.TgZ(0,"th"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t))}}function S(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",16)(1,"p-multiSelect",17),e.NdJ("onChange",function(o){e.CHM(t);const s=e.oxw().$implicit,r=e.oxw().$implicit;return e.oxw(2).selectJury(o,r,s)}),e.qZA(),e.TgZ(2,"button",18),e.NdJ("click",function(o){e.CHM(t);const s=e.oxw().$implicit,r=e.oxw(),c=r.$implicit,d=r.index;return e.oxw(2).validerJury(o,c,s,d)}),e._uU(3," Valider "),e.qZA()()}if(2&i){const t=e.oxw(2).index,n=e.oxw(2);e.xp6(1),e.Q6J("options",n.juries)("disabled",n.disabledMap.get(t)||!1)}}function A(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"input",19),e.NdJ("change",function(o){e.CHM(t);const s=e.oxw().$implicit,r=e.oxw(),c=r.$implicit,d=r.index;return e.oxw(2).validerJury(o,c,s,d)}),e.qZA()}if(2&i){const t=e.oxw(2).index;e.MGl("id","checkbox",t,"")}}function M(i,a){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,S,4,2,"div",14),e.YNc(2,A,1,1,"input",15),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf","ADMIN"==t.userConnected.role),e.xp6(1),e.Q6J("ngIf","ADMIN"!=t.userConnected.role)}}function J(i,a){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.YNc(3,M,3,2,"td",13),e.qZA()),2&i){const t=a.$implicit,n=e.oxw(2);e.xp6(2),e.hij("",t," "),e.xp6(1),e.Q6J("ngForOf",n.datesOfDisponibilities)}}function U(i,a){if(1&i&&(e.TgZ(0,"table",12)(1,"thead")(2,"th"),e._uU(3,"Horaire"),e.qZA(),e.YNc(4,T,3,3,"th",13),e.qZA(),e.TgZ(5,"tbody"),e.YNc(6,J,4,2,"tr",13),e.qZA()()),2&i){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.datesOfDisponibilities),e.xp6(2),e.Q6J("ngForOf",t.horaires)}}let j=(()=>{class i{constructor(t,n,o,s,r,c,d,p){this.disponibilitySrv=t,this.sessionSrv=n,this.compteSrv=o,this.commonService=s,this.storageService=r,this.compteDisponibiliteService=c,this.router=d,this.messageService=p,this.disponibilities=[],this.datesOfDisponibilities=[],this.horaires=[],this.juries=[],this.i=0,this.selectDisponibilities=[]}ngOnInit(){this.disponibilityMap=new Map,this.disabledMap=new Map,this.juriesByDispo=new Map,this.getActiveSession(),this.userConnected=this.storageService.getUserConnected(),this.userConnected.role==v.u.ADMIN&&this.getJuryComptes(),this.getDisponibilities()}getActiveSession(){this.sessionSrv.getActive().subscribe({next:t=>{this.session=t}})}getJuryComptes(){this.compteSrv.findByRole(v.u.JURY).subscribe({next:t=>{this.juries=t},error:t=>{console.log("error: ",t)}})}getDisponibilities(){this.disponibilitySrv.liste().subscribe({next:t=>{this.disponibilities=t;let n=[];for(let s=0;s<this.disponibilities.length;s++){const r=this.disponibilities[s];let c=new Date(r.date_disponibilite).getTime();n.includes(c)||n.push(c);let u=this.commonService.formatDate(r.debut_disponibilite)+" - "+this.commonService.formatDate(r.fin_disponibilite);this.horaires.includes(u)||this.horaires.push(u),this.disponibilityMap.set(u+" - "+c,r.id||0)}let o=new Set(n);this.datesOfDisponibilities=[...o],this.datesOfDisponibilities.sort()},error:t=>{}})}enregistrerLesHoraires(){let t=0;for(let n=0;n<this.selectDisponibilities.length;n++){const o=this.selectDisponibilities[n];this.compteDisponibiliteService.create({disponibilite_id:o.disponibilityId,compteId:o.jury}).subscribe({next:s=>{this.messageService.add({severity:"success",summary:"Selection de la plage",detail:"Selection de la plage \xe9ffectu\xe9e avec success"}),t+=1},error:s=>{console.log("Error: ",s),this.messageService.add({severity:"error",summary:"Erreur de s\xe9lection de la plage",detail:s.message})}})}t>=this.selectDisponibilities.length&&this.router.navigate(["calendrier_entretiens"])}selectJury(t,n,o){this.juriesByDispo.set(n+" - "+o,t.value)}validerJury(t,n,o,s){let r=this.disponibilityMap.get(n+" - "+o);if(this.userConnected.role==v.u.ADMIN){let c=this.juriesByDispo.get(n+" - "+o)||[];for(let d=0;d<c.length;d++)this.selectDisponibilities.push({disponibilityId:r,selectId:s,jury:c[d].id||0});this.disabledMap.set(s,!0)}else{let c={disponibilityId:r,selectId:s,jury:this.userConnected.id||0};if(t.target.checked)this.selectDisponibilities.push(c);else{let d=this.selectDisponibilities.findIndex(p=>p.jury==this.userConnected.id);d>-1&&this.selectDisponibilities.splice(d,1)}}}reset(){window.location.reload()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(x.T),e.Y36(y.K),e.Y36(I.D),e.Y36(Z.v),e.Y36(C.V),e.Y36(D.R),e.Y36(m.F0),e.Y36(E.ez))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-intervenant-entretien"]],decls:21,vars:1,consts:[[1,"calendrier-disponibilite-page","calendrier-page","page-content"],[1,"page-title"],[1,"pi","pi-angle-right"],[1,"card"],[1,"header"],[1,"title"],[1,"line"],[1,"calendrier"],["id","table",4,"ngIf"],[1,"footer"],[1,"btn-group"],["type","button",1,"btn","btn-info",3,"click"],["id","table"],[4,"ngFor","ngForOf"],["class","v-center",4,"ngIf"],["type","checkbox",3,"id","change",4,"ngIf"],[1,"v-center"],["defaultLabel","Selectionner des membres","optionLabel","name","display","chip",3,"options","disabled","onChange"],["type","button",1,"ml-2","btn","btn-info",3,"click"],["type","checkbox",3,"id","change"]],template:function(t,n){1&t&&(e.TgZ(0,"section",0)(1,"h1",1),e._uU(2," Entretiens "),e._UZ(3,"i",2),e._uU(4," Horaire de disponibilit\xe9s"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"h3",5),e._uU(8,"Veuillez selectionner vos horaires "),e.qZA(),e.TgZ(9,"p"),e._uU(10,"Au niveau de cette page vous avez la liste des jours d'entretiens et les quart times de disponibilit\xe9. Veuillez selectionner le quart time auquel vous serez disponible ces diff\xe9rents jours."),e.qZA()(),e._UZ(11,"div",6),e.TgZ(12,"div",7),e.YNc(13,U,7,2,"table",8),e.TgZ(14,"section"),e._uU(15," Veuillez definir des p\xe9riodes de disponibilit\xe9s afin de selectionner les horaires qui vous interessent "),e.qZA()(),e.TgZ(16,"div",9),e._UZ(17,"div",6),e.TgZ(18,"div",10)(19,"button",11),e.NdJ("click",function(){return n.enregistrerLesHoraires()}),e._uU(20," Soumettre "),e.qZA()()()()()),2&t&&(e.xp6(13),e.Q6J("ngIf",n.datesOfDisponibilities.length>0))},directives:[h.O5,h.sg,_.NU],pipes:[h.uU],encapsulation:2}),i})();var f=l(7618);const N=[{path:"",component:j,canActivate:[f.a]}];let Y=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[f.a],imports:[[m.Bz.forChild(N)],m.Bz]}),i})(),O=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[h.ez,Y,b.u5,b.UX,_.q4]]}),i})()}}]);