"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[386],{9930:(M,C,l)=>{l.d(C,{u:()=>x});var m=l(2340),g=l(7587),e=l(520),D=l(4920);let x=(()=>{class _{constructor(n,h){this.http=n,this.baseUrlSvr=h,this.url="",this.url=`${this.baseUrlSvr.getOrigin()}${m.N.candidaturePath}`,this.url+="candidature/"}liste(){return this.http.get(this.url+"candidats")}update(n,h){return this.http.patch(this.url+"candidats/update/"+n,h)}allByZone(n){return this.http.get(this.url+"allbyzone/"+n)}allSolvableByZone(n,h){return this.http.get(this.url+"allbysolvabilitezone/"+n+"/"+h)}allAdmissibleByZone(n){return this.http.get(this.url+"admissiblebyzone/"+n)}allAdmissByZone(n){return this.http.get(this.url+"admisbyzone/"+n)}allByCentre(n){return this.http.get(this.url+"allbycentreexamen/"+n)}allSolvableByCentre(n,h){return this.http.get(this.url+"allbysolvabilitecentreexamen/"+n+"/"+h)}allAdmissibleByCentre(n){return this.http.get(this.url+"admissiblebycentreexamen/"+n)}allAdmissByCentre(n){return this.http.get(this.url+"admisbycentreexamen/"+n)}allBySite(n){return this.http.get(this.url+"allbysite/"+n)}allSolvableBySite(n,h){return this.http.get(this.url+"allbysolvabilitesite/"+n+"/"+h)}allAdmissibleBySite(n){return this.http.get(this.url+"admissiblebysite/"+n)}allAdmissBySite(n){return this.http.get(this.url+"admisbysite/"+n)}getOne(n){return this.http.get(this.url+n)}getStatistics(){return this.http.get(this.url+"statistics")}downloadCandidatureFile(){return this.http.get(this.url+"candidatures/download",{responseType:"blob"})}downloadAdmissibleCandidatureFile(){return this.http.get(this.url+"candidatures/download",{responseType:"blob"})}downloadAdmissibleCandidatureFileByZone(n){return this.http.get(this.url+"download/admissiblebyzone/"+n,{responseType:"blob"})}downloadAdmissibleCandidatureFileByCentre(n){return this.http.get(this.url+"download/admissiblebycentreexamen/"+n,{responseType:"blob"})}downloadAdmissibleCandidatureFileBySite(n){return this.http.get(this.url+"download/admissiblebysite/"+n,{responseType:"blob"})}downloadAdmissCandidatureFile(){return this.http.get(this.url+"candidatures/download",{responseType:"blob"})}downloadAdmisCandidatureFileByZone(n){return this.http.get(this.url+"download/admisbyzone/"+n,{responseType:"blob"})}downloadAdmisCandidatureFileByCentre(n){return this.http.get(this.url+"download/admisbycentreexamen/"+n,{responseType:"blob"})}downloadAdmisCandidatureFileBySite(n){return this.http.get(this.url+"download/admisbyste/"+n,{responseType:"blob"})}delete(n){return this.http.delete(this.url+n)}}return _.\u0275fac=function(n){return new(n||_)(g.LFG(e.eN),g.LFG(D.x))},_.\u0275prov=g.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},386:(M,C,l)=>{l.r(C),l.d(C,{CalendrierDisponibiliteModule:()=>K});var m=l(9808),g=l(6093),e=l(7587),D=l(9930),x=l(62),_=l(8766),T=l(7212),n=l(9099),h=l(9783),Z=l(7671),O=l(7921),w=l(4036),f=l(2382);function U(i,a){if(1&i&&(e.TgZ(0,"th"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t))}}function N(i,a){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t," ")}}const E=function(i){return{interviewer:i}};function I(i,a){if(1&i&&(e.TgZ(0,"td",20),e.YNc(1,N,2,1,"div",8),e.qZA()),2&i){const t=a.$implicit,s=e.oxw().$implicit,o=e.oxw(2);let r;e.Q6J("ngClass",e.VKq(2,E,(null==(r=o.interverwerMap.get(s+" - "+t.toString()))?null:r.length)||!1)),e.xp6(1),e.Q6J("ngForOf",o.interverwerMap.get(s+" - "+t.toString()))}}function F(i,a){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.YNc(3,I,2,4,"td",19),e.qZA()),2&i){const t=a.$implicit,s=e.oxw(2);e.xp6(2),e.hij("",t," "),e.xp6(1),e.Q6J("ngForOf",s.datesOfDisponibilities)}}function B(i,a){if(1&i&&(e.TgZ(0,"tbody"),e.YNc(1,F,4,2,"tr",8),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.horaires)}}function J(i,a){1&i&&(e.TgZ(0,"tbody")(1,"tr")(2,"td"),e._uU(3,"Aucun membre du jury n'a encore de periode disponible pour les entretiens"),e.qZA()()())}function q(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().previousDate()}),e._uU(1," Precedent Date "),e.qZA()}}function Y(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().prochaineDate()}),e._uU(1," Prochaine Date "),e.qZA()}}function Q(i,a){if(1&i&&(e.TgZ(0,"h3",5),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.currentDate))}}function P(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"p-dropdown",26),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(3).selectCandidat=o})("onChange",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).handleCandidatSelect(o,r)}),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("options",t.candidats)("ngModel",t.selectCandidat)("showClear",!0)}}function L(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"p-dropdown",27),e.NdJ("onChange",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).handleInterviewerSelect(o,r)})("ngModelChange",function(o){return e.CHM(t),e.oxw(3).interviewer=o}),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(2),e.Oqu(""),e.xp6(2),e.Oqu(""),e.xp6(2),e.Oqu(""),e.xp6(2),e.Q6J("options",t.interviewers)("showClear",!0)("ngModel",t.interviewer)}}function z(i,a){1&i&&(e.TgZ(0,"td",28),e._uU(1,"Pause"),e.qZA())}function j(i,a){if(1&i&&(e.TgZ(0,"tr")(1,"td")(2,"p"),e._uU(3),e.qZA(),e.YNc(4,P,1,3,"p-dropdown",24),e.qZA(),e.YNc(5,L,9,6,"ng-container",9),e.YNc(6,z,2,0,"td",25),e.qZA()),2&i){const t=a.$implicit;e.xp6(3),e.Oqu(t),e.xp6(1),e.Q6J("ngIf","12h00 - 13h00"!=t),e.xp6(1),e.Q6J("ngIf","12h00 - 13h00"!=t),e.xp6(1),e.Q6J("ngIf","12h00 - 13h00"===t)}}function $(i,a){if(1&i&&(e.TgZ(0,"div",23)(1,"table",7)(2,"thead")(3,"th"),e._uU(4,"Horaire"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Centre d'examen"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Noms"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Pr\xe9noms"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Intervenant"),e.qZA()(),e.TgZ(13,"tbody"),e.YNc(14,j,7,4,"tr",8),e.qZA()()()),2&i){const t=e.oxw();e.xp6(14),e.Q6J("ngForOf",t.entretienTimes)}}let H=(()=>{class i{constructor(t,s,o,r,c,p,d,u){this.candidatureSrv=t,this.commonService=s,this.noteService=o,this.compteDisponibiliteService=r,this.compteService=c,this.messageService=p,this.router=d,this.sessionSrv=u,this.entretienTimes=["08h30 - 09h00","09h00 - 09h30","09h30 - 10h00","10h00 - 10h30","10h30 - 11h00","11h00 - 11h30","11h30 - 12h00","12h00 - 13h00","13h00 - 13h30","13h30 - 14h00","14h00 - 14h30","14h30 - 15h00","15h00 - 15h30","15h30 - 16h00","16h00 - 16h30"],this.interviewers=[],this.indexCurrentDate=0,this.datesOfDisponibilities=[],this.datesOfEntretiens=[],this.horaires=[],this.juries=[],this.candidats=[]}ngOnInit(){this.entretienNoteMap=new Map,this.interverwerMap=new Map,this.getActiveSession(),this.getCandidatures(),this.getCompteDisponibilite()}getActiveSession(){this.sessionSrv.getActive().subscribe({next:t=>{this.session=t;let s=new Date(this.session.date_debut_entretien),o=new Date(this.session.date_fin_entretien);this.datesOfEntretiens=this.commonService.genererDates(s.getTime(),o.getTime()),this.indexCurrentDate=0,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate]}})}getCandidatures(){this.candidatureSrv.liste().subscribe({next:t=>{this.candidats=t}})}getCompteDisponibilite(){this.compteDisponibiliteService.liste().subscribe({next:t=>{var s,o;let r=[],c=[];for(let d of t){let u=new Date(d.disponibilite.date_disponibilite).getTime();r.findIndex(v=>v==u)<=-1&&r.push(u),this.juries.push(d.compte);let k=this.commonService.buildDateWithTime(d.disponibilite.debut_disponibilite.toString()),G=this.commonService.buildDateWithTime(d.disponibilite.fin_disponibilite.toString()),b=this.commonService.formatDate(k)+" - "+this.commonService.formatDate(G);this.horaires.findIndex(v=>v==b)<=-1&&this.horaires.push(b);let y=[],S=(null===(s=d.compte)||void 0===s?void 0:s.name)+" "+(null===(o=d.compte)||void 0===o?void 0:o.prenom);if(this.interverwerMap.has(b+" - "+u)){let v=this.interverwerMap.get(b+" - "+u)||[];y.push(...v)}y.push(S),c.push(S),this.interverwerMap.set(b+" - "+u,y)}let p=new Set(r);this.datesOfDisponibilities=[...p],this.datesOfDisponibilities.sort(),this.interviewers=[...new Set(c)]}})}handleCandidatSelect(t,s){let o=t.value,r=new g.j,c=this.commonService.buildDate(this.currentDate,s);if(r.debut_entretien=new Date(c.startDate),r.fin_entretien=new Date(c.endDate),r.candidature_id=o.id||0,r.candidature=o,this.entretienNoteMap.has(s+" - "+this.currentDate.getTime().toString())){let p=this.entretienNoteMap.get(s+" - "+this.currentDate.getTime().toString());p.candidature=r.candidature,p.candidature_id=r.candidature_id,p.debut_entretien=r.debut_entretien,p.fin_entretien=r.fin_entretien,r=p}this.entretienNoteMap.set(s+" - "+this.currentDate.getTime().toString(),r)}handleInterviewerSelect(t,s){let o=t.value,r=new g.j,c=this.commonService.buildDate(this.currentDate,s);r.debut_entretien=new Date(c.startDate),r.fin_entretien=new Date(c.endDate);let p=this.juries.find(d=>(null==d?void 0:d.name)+" "+(null==d?void 0:d.prenom)==o);if(r.compte_id=p.id||0,r.compte=p,this.entretienNoteMap.has(s+" - "+this.currentDate.getTime().toString())){let d=this.entretienNoteMap.get(s+" - "+this.currentDate.getTime().toString());d.compte=r.compte,d.compte_id=r.compte_id,d.debut_entretien=r.debut_entretien,d.fin_entretien=r.fin_entretien,r=d}this.entretienNoteMap.set(s+" - "+this.currentDate.getTime().toString(),r)}addNote(){this.entretienNoteMap.forEach((t,s,o)=>{this.noteService.create({candidature_id:t.candidature_id,compte_id:t.compte.id||0,debut_entretien:t.debut_entretien,fin_entretien:t.fin_entretien,note:0}).subscribe({next:r=>{var c,p,d,u;this.messageService.add({severity:"success",summary:"Assignation du jury ",detail:"Assignation du jury "+(null===(c=t.compte)||void 0===c?void 0:c.name)+" "+(null===(p=t.compte)||void 0===p?void 0:p.prenom)+" pour un entretien avec le candidat "+(null===(d=t.candidature)||void 0===d?void 0:d.compte.name)+" "+(null===(u=t.candidature)||void 0===u?void 0:u.compte.prenom)+" effectu\xe9e avec success pour la date du "+this.currentDate.toString()})},error:r=>{this.messageService.add({severity:"error",summary:"Erreur d'assignation",detail:r.message}),console.log("Error: ",r)}})})}prochaineDate(){this.currentDate=this.datesOfEntretiens[this.indexCurrentDate+1],this.indexCurrentDate=this.indexCurrentDate+1,this.reset()}previousDate(){this.currentDate=this.datesOfEntretiens[this.indexCurrentDate-1],this.indexCurrentDate=this.indexCurrentDate-1,this.reset()}reset(){this.interviewer="",this.selectCandidat={},this.entretienNoteMap=new Map}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.u),e.Y36(x.v),e.Y36(_.Y),e.Y36(T.R),e.Y36(n.D),e.Y36(h.ez),e.Y36(Z.F0),e.Y36(O.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-calendrier-disponibilite"]],decls:37,vars:10,consts:[[1,"calendrier-disponibilite-page","calendrier-page","page-content"],[1,"page-title"],[1,"pi","pi-angle-right"],[1,"page-header"],[1,"header"],[1,"title"],[1,"line"],["id","table"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"card"],["class","btn btn-danger mr-1",3,"click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"sub-header"],["class","title",4,"ngIf"],["class","calendrier",4,"ngIf"],[1,"footer"],[1,"btn-group"],["type","submit",1,"btn","btn-info",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"btn","btn-danger","mr-1",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"calendrier"],["optionLabel","compte.email","name","candidat","id","candidat","placeholder","Choisir un candidat",3,"options","ngModel","showClear","ngModelChange","onChange",4,"ngIf"],["colspan","4","class","pause",4,"ngIf"],["optionLabel","compte.email","name","candidat","id","candidat","placeholder","Choisir un candidat",3,"options","ngModel","showClear","ngModelChange","onChange"],["placeholder","Choisir un intervenant",3,"options","showClear","ngModel","onChange","ngModelChange"],["colspan","4",1,"pause"]],template:function(t,s){1&t&&(e.TgZ(0,"section",0)(1,"h1",1),e._uU(2," Entretiens "),e._UZ(3,"i",2),e._uU(4," Calendrier des disponibilit\xe9s"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"h3",5),e._uU(8,"Disponibilit\xe9 des membres du jury"),e.qZA()(),e._UZ(9,"div",6),e.qZA(),e.TgZ(10,"div")(11,"table",7)(12,"thead")(13,"th"),e._uU(14,"Horaire"),e.qZA(),e.YNc(15,U,3,3,"th",8),e.qZA(),e.YNc(16,B,2,1,"tbody",9),e.YNc(17,J,4,0,"tbody",9),e.qZA()(),e.TgZ(18,"div",10)(19,"div",4)(20,"h3",5),e._uU(21),e.ALo(22,"date"),e.qZA(),e.TgZ(23,"div"),e.YNc(24,q,2,0,"button",11),e.YNc(25,Y,2,0,"button",12),e.qZA()(),e._UZ(26,"div",6),e.TgZ(27,"div",13)(28,"h3",5),e._uU(29,"Entretiens concours Ucac-Icam"),e.qZA(),e.YNc(30,Q,3,3,"h3",14),e.qZA(),e.YNc(31,$,15,1,"div",15),e.TgZ(32,"div",16),e._UZ(33,"div",6),e.TgZ(34,"div",17)(35,"button",18),e.NdJ("click",function(){return s.addNote()}),e._uU(36," Soumettre "),e.qZA()()()()()),2&t&&(e.xp6(15),e.Q6J("ngForOf",s.datesOfDisponibilities),e.xp6(1),e.Q6J("ngIf",s.datesOfDisponibilities.length>0),e.xp6(1),e.Q6J("ngIf",0==s.datesOfDisponibilities.length),e.xp6(4),e.hij("Entretiens concours, session du ",e.lcZ(22,8,null==s.session?null:s.session.date_examen),""),e.xp6(3),e.Q6J("ngIf",s.datesOfEntretiens.length>1),e.xp6(1),e.Q6J("ngIf",s.datesOfEntretiens.length>1),e.xp6(5),e.Q6J("ngIf",s.currentDate),e.xp6(1),e.Q6J("ngIf",null!=s.currentDate&&null!=s.currentDate))},directives:[m.sg,m.O5,m.mk,w.Lt,f.JJ,f.On],pipes:[m.uU],encapsulation:2}),i})();var A=l(7618);const R=[{path:"",component:H,canActivate:[A.a]}];let W=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[A.a],imports:[[Z.Bz.forChild(R)],Z.Bz]}),i})(),K=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[m.ez,W,f.u5,f.UX,w.kW]]}),i})()}}]);