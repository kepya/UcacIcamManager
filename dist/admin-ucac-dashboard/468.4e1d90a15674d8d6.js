"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[468],{9468:(T,v,o)=>{o.r(v),o.d(v,{CalendrierEntretienModule:()=>y});var g=o(9808),m=o(5193),e=o(7587),h=o(8766),f=o(1303),r=o(7212),d=o(62),t=o(7921),u=o(4036),_=o(2382);function E(i,l){if(1&i){const n=e.EpF();e.TgZ(0,"p-dropdown",16),e.NdJ("onChange",function(c){return e.CHM(n),e.oxw().handleInterviewerSelect(c)})("ngModelChange",function(c){return e.CHM(n),e.oxw().interviewer=c}),e.qZA()}if(2&i){const n=e.oxw();e.Q6J("options",n.interviewers)("showClear",!0)("ngModel",n.interviewer)}}function D(i,l){if(1&i){const n=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){return e.CHM(n),e.oxw().previousDate()}),e._uU(1," Precedent Date "),e.qZA()}}function A(i,l){if(1&i){const n=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){return e.CHM(n),e.oxw().prochaineDate()}),e._uU(1," Prochaine Date "),e.qZA()}}function x(i,l){if(1&i&&(e.TgZ(0,"h3",5),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,n.currentDate))}}function M(i,l){if(1&i&&(e.TgZ(0,"td",20)(1,"div"),e._uU(2),e.qZA()()),2&i){const n=e.oxw().$implicit,s=e.oxw();e.uIk("rowspan",s.entretiensBeforeBreak.length+1),e.xp6(2),e.Oqu(n.interviewer)}}function I(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.YNc(11,M,3,2,"td",19),e.qZA()),2&i){const n=l.$implicit,s=l.index;e.xp6(2),e.hij("",e.xi3(3,5,n.disponibility.debut_disponibilite,"H:mm")+" - "+e.xi3(4,8,n.disponibility.fin_disponibilite,"H:mm")," "),e.xp6(4),e.Oqu(n.centre),e.xp6(2),e.Oqu(n.candidat.compte.name),e.xp6(2),e.Oqu(n.candidat.compte.prenom),e.xp6(1),e.Q6J("ngIf",0==s)}}function w(i,l){if(1&i&&(e.TgZ(0,"td",20)(1,"div"),e._uU(2),e.qZA()()),2&i){const n=e.oxw().$implicit,s=e.oxw();e.uIk("rowspan",s.entretiensAfterBreak.length+1),e.xp6(2),e.Oqu(n.interviewer)}}function S(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.YNc(11,w,3,2,"td",19),e.qZA()),2&i){const n=l.$implicit,s=l.index;e.xp6(2),e.hij("",e.xi3(3,5,n.disponibility.debut_disponibilite,"H:mm")+" - "+e.xi3(4,8,n.disponibility.fin_disponibilite,"H:mm")," "),e.xp6(4),e.Oqu(n.centre),e.xp6(2),e.Oqu(n.candidat.compte.name),e.xp6(2),e.Oqu(n.candidat.compte.prenom),e.xp6(1),e.Q6J("ngIf",0==s)}}let O=(()=>{class i{constructor(n,s,c,a,p){this.noteService=n,this.storageService=s,this.compteDisponibiliteService=c,this.commonService=a,this.sessionSrv=p,this.interviewers=[],this.entretiensBeforeBreak=[],this.entretiensAfterBreak=[],this.datesOfEntretiens=[],this.indexCurrentDate=0}ngOnInit(){this.currentDate=new Date,this.getActiveSession(),this.compte=this.storageService.getUserConnected(),this.compte.role==m.u.JURY&&(this.interviewer=this.compte.name+" "+this.compte.prenom,this.getEntretiens()),this.getCompteDisponibilite()}getCompteDisponibilite(){this.compteDisponibiliteService.liste().subscribe({next:n=>{var s,c;let a=[];for(let p of n)a.push((null===(s=p.compte)||void 0===s?void 0:s.name)+" "+(null===(c=p.compte)||void 0===c?void 0:c.prenom));this.interviewers=[...new Set(a)]}})}getActiveSession(){this.sessionSrv.getActive().subscribe({next:n=>{let s=new Date(n.date_debut_entretien),c=new Date(n.date_fin_entretien);this.datesOfEntretiens=this.commonService.genererDates(s.getTime(),c.getTime()),this.indexCurrentDate=0,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate]}})}handleInterviewerSelect(n){this.getEntretiens()}getEntretiens(){this.noteService.liste().subscribe({next:n=>{let s=n.filter(a=>{var p,C;return new Date(a.debut_entretien).getDate()===this.currentDate.getDate()&&(null===(p=a.compte)||void 0===p?void 0:p.name)+" "+(null===(C=a.compte)||void 0===C?void 0:C.prenom)===this.interviewer});s.sort((a,p)=>new Date(a.fin_entretien).getTime()-new Date(p.fin_entretien).getTime());let c=s.map(a=>{var p,C,b;return{centre:(null===(p=a.candidature)||void 0===p?void 0:p.centre)||"",interviewer:(null===(C=a.compte)||void 0===C?void 0:C.name)+" "+(null===(b=a.compte)||void 0===b?void 0:b.prenom),candidat:a.candidature,disponibility:{date_disponibilite:a.debut_entretien,debut_disponibilite:new Date(a.debut_entretien),fin_disponibilite:new Date(a.fin_entretien)}}});this.entretiensBeforeBreak=c.filter(a=>a.disponibility.fin_disponibilite.getHours()<=12),this.entretiensAfterBreak=c.filter(a=>a.disponibility.fin_disponibilite.getHours()>12)},error:n=>{console.log("error: ",n)}})}prochaineDate(){this.indexCurrentDate<this.datesOfEntretiens.length&&(this.indexCurrentDate=this.indexCurrentDate>this.datesOfEntretiens.length?this.datesOfEntretiens.length-1:this.indexCurrentDate+1,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate],this.getEntretiens())}previousDate(){this.indexCurrentDate>0&&(this.indexCurrentDate=this.indexCurrentDate<0?0:this.indexCurrentDate-1,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate],this.getEntretiens())}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(h.Y),e.Y36(f.V),e.Y36(r.R),e.Y36(d.v),e.Y36(t.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-calendrier-entretien"]],decls:39,vars:6,consts:[[1,"calendrier-entretien-page","calendrier-page","page-content"],[1,"page-title"],[1,"pi","pi-angle-right"],[1,"card"],[1,"header"],[1,"title"],["placeholder","Choisir un intervenant",3,"options","showClear","ngModel","onChange","ngModelChange",4,"ngIf"],["class","btn btn-danger ml-1 mr-1",3,"click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"line"],[1,"sub-header"],["class","title",4,"ngIf"],[1,"calendrier"],["id","table"],[4,"ngFor","ngForOf"],["colspan","4",1,"pause"],["placeholder","Choisir un intervenant",3,"options","showClear","ngModel","onChange","ngModelChange"],[1,"btn","btn-danger","ml-1","mr-1",3,"click"],[1,"btn","btn-primary",3,"click"],["class","rowspan",4,"ngIf"],[1,"rowspan"]],template:function(n,s){1&n&&(e.TgZ(0,"section",0)(1,"h1",1),e._uU(2," Entretiens "),e._UZ(3,"i",2),e._uU(4," Calendrier des entretiens"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"h3",5),e._uU(8,"Calendrier final des entretiens"),e.qZA(),e.TgZ(9,"div"),e.YNc(10,E,1,3,"p-dropdown",6),e.YNc(11,D,2,0,"button",7),e.YNc(12,A,2,0,"button",8),e.qZA()(),e._UZ(13,"div",9),e.TgZ(14,"div",10)(15,"h3",5),e._uU(16,"Entretiens concours Ucac-Icam"),e.qZA(),e.YNc(17,x,3,3,"h3",11),e.qZA(),e.TgZ(18,"div",12)(19,"table",13)(20,"thead")(21,"th"),e._uU(22,"Horaire"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Centre d'examen"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Noms"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Pr\xe9nom"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Intervenants"),e.qZA()(),e.TgZ(31,"tbody"),e.YNc(32,I,12,11,"tr",14),e.TgZ(33,"tr")(34,"td"),e._uU(35,"12h00 - 13h00"),e.qZA(),e.TgZ(36,"td",15),e._uU(37,"Pause"),e.qZA()(),e.YNc(38,S,12,11,"tr",14),e.qZA()()()()()),2&n&&(e.xp6(10),e.Q6J("ngIf","JURY"!=s.compte.role),e.xp6(1),e.Q6J("ngIf",s.datesOfEntretiens.length>1),e.xp6(1),e.Q6J("ngIf",s.datesOfEntretiens.length>1),e.xp6(5),e.Q6J("ngIf",s.currentDate),e.xp6(15),e.Q6J("ngForOf",s.entretiensBeforeBreak),e.xp6(6),e.Q6J("ngForOf",s.entretiensAfterBreak))},directives:[g.O5,u.Lt,_.JJ,_.On,g.sg],pipes:[g.uU],encapsulation:2}),i})();var U=o(7671),Z=o(7618);const P=[{path:"",component:O,canActivate:[Z.a]},{path:"**",component:O,canActivate:[Z.a]}];let B=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[Z.a],imports:[[U.Bz.forChild(P)],U.Bz]}),i})(),y=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[g.ez,B,_.u5,_.UX,u.kW]]}),i})()},7921:(T,v,o)=>{o.d(v,{K:()=>f});var g=o(2340),m=o(7587),e=o(520),h=o(4920);let f=(()=>{class r{constructor(t,u){this.http=t,this.baseUrlSvr=u,this.url="",this.url=`${this.baseUrlSvr.getOrigin()}${g.N.administrationPath}`,this.url+="session/"}liste(){return this.http.get(this.url+"all")}getOne(t){return this.http.get(this.url+t)}getActive(){return this.http.get(this.url+"active")}getNext(){return this.http.get(this.url+"next")}create(t){return this.http.post(this.url+"create",t)}update(t){return this.http.patch(this.url+(null==t?void 0:t.id),t)}updateForEntretien(t){return this.http.patch(this.url+"date_entretiens/"+(null==t?void 0:t.id),t)}delete(t){return this.http.delete(this.url+t)}}return r.\u0275fac=function(t){return new(t||r)(m.LFG(e.eN),m.LFG(h.x))},r.\u0275prov=m.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},62:(T,v,o)=>{o.d(v,{v:()=>e});var g=o(9808),m=o(7587);let e=(()=>{class h{constructor(){}calculerJours(r,d){var t=Math.abs(d-r);return Math.floor(t/864e5)}getFormationLabel(r){return"Ing\xe9nieur g\xe9n\xe9raliste parcours international"==r?"OP":"Ing\xe9nieur g\xe9n\xe9raliste par apprentissage ou g\xe9nie des proc\xe9d\xe9s"==r?"L":"Ing\xe9nieur genie des proc\xe9d\xe9s"==r?"IP":"Ing\xe9nieur g\xe9neraliste parcours international et innovation"==r?"I":"Ing\xe9nieur g\xe9nie Informtique"==r?"X":""}genererDates(r,d){let t=this.calculerJours(r,d);console.log("nombre jour:",t);let u=[],_=new Date(r);u.push(new Date(r));for(let E=0;E<t;E++)_.setDate(_.getDate()+1),u.push(new Date(_));return u}formatDate(r){let t=(0,g.p6)(r,"shortTime","fr-FR").split(":");return t[0]+"h"+t[1]}buildDateWithTime(r){const d=new Date;return new Date(`${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()} ${r}`)}buildDate(r,d){let u,_,t=d.split("-"),D=t[0].split("h");r.setHours(parseInt(D[0],10)),r.setMinutes(parseInt(D[1],10)),u=r.getTime();let x=t[1].split("h");return r.setHours(parseInt(x[0],10)),r.setMinutes(parseInt(x[1],10)),_=r.getTime(),{startDate:u,endDate:_}}}return h.\u0275fac=function(r){return new(r||h)},h.\u0275prov=m.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},7212:(T,v,o)=>{o.d(v,{R:()=>f});var g=o(2340),m=o(7587),e=o(520),h=o(4920);let f=(()=>{class r{constructor(t,u){this.http=t,this.baseUrlSvr=u,this.url="",this.url=`${this.baseUrlSvr.getOrigin()}${g.N.interviewPath}`,this.url+="comptedisponibilite/"}liste(){return this.http.get(this.url+"all")}allBySession(t){return this.http.get(this.url+"bysession/"+t)}getOne(t){return this.http.get(this.url+t)}create(t){return this.http.post(this.url+"create",t)}update(t){return this.http.patch(this.url+(null==t?void 0:t.id),t)}delete(t){return this.http.delete(this.url+t)}}return r.\u0275fac=function(t){return new(t||r)(m.LFG(e.eN),m.LFG(h.x))},r.\u0275prov=m.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);