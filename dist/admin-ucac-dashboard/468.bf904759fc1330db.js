"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[468],{9468:(T,_,s)=>{s.r(_),s.d(_,{CalendrierEntretienModule:()=>S});var m=s(9808),e=s(7587),v=s(8766),p=s(7212),f=s(62),r=s(7921),l=s(4036),t=s(2382);function u(i,d){if(1&i){const n=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){return e.CHM(n),e.oxw().previousDate()}),e._uU(1," Precedent Date "),e.qZA()}}function g(i,d){if(1&i){const n=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){return e.CHM(n),e.oxw().prochaineDate()}),e._uU(1," Prochaine Date "),e.qZA()}}function D(i,d){if(1&i&&(e.TgZ(0,"h3",5),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,n.currentDate))}}function E(i,d){if(1&i&&(e.TgZ(0,"td",19)(1,"div"),e._uU(2),e.qZA()()),2&i){const n=e.oxw().$implicit,o=e.oxw();e.uIk("rowspan",o.entretiensBeforeBreak.length+1),e.xp6(2),e.Oqu(n.interviewer)}}function A(i,d){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.YNc(11,E,3,2,"td",18),e.qZA()),2&i){const n=d.$implicit,o=d.index;e.xp6(2),e.hij("",e.xi3(3,5,n.disponibility.debut_disponibilite,"H:mm")+" - "+e.xi3(4,8,n.disponibility.fin_disponibilite,"H:mm")," "),e.xp6(4),e.Oqu(n.centre),e.xp6(2),e.Oqu(n.candidat.compte.name),e.xp6(2),e.Oqu(n.candidat.compte.prenom),e.xp6(1),e.Q6J("ngIf",0==o)}}function x(i,d){if(1&i&&(e.TgZ(0,"td",19)(1,"div"),e._uU(2),e.qZA()()),2&i){const n=e.oxw().$implicit,o=e.oxw();e.uIk("rowspan",o.entretiensAfterBreak.length+1),e.xp6(2),e.Oqu(n.interviewer)}}function M(i,d){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.YNc(11,x,3,2,"td",18),e.qZA()),2&i){const n=d.$implicit,o=d.index;e.xp6(2),e.hij("",e.xi3(3,5,n.disponibility.debut_disponibilite,"H:mm")+" - "+e.xi3(4,8,n.disponibility.fin_disponibilite,"H:mm")," "),e.xp6(4),e.Oqu(n.centre),e.xp6(2),e.Oqu(n.candidat.compte.name),e.xp6(2),e.Oqu(n.candidat.compte.prenom),e.xp6(1),e.Q6J("ngIf",0==o)}}let O=(()=>{class i{constructor(n,o,c,a){this.noteService=n,this.compteDisponibiliteService=o,this.commonService=c,this.sessionSrv=a,this.interviewers=[],this.entretiensBeforeBreak=[],this.entretiensAfterBreak=[],this.datesOfEntretiens=[],this.indexCurrentDate=0}ngOnInit(){this.currentDate=new Date,this.getActiveSession(),this.getCompteDisponibilite()}getCompteDisponibilite(){this.compteDisponibiliteService.liste().subscribe({next:n=>{var o,c;let a=[];for(let h of n)a.push((null===(o=h.compte)||void 0===o?void 0:o.name)+" "+(null===(c=h.compte)||void 0===c?void 0:c.prenom));this.interviewers=[...new Set(a)]}})}getActiveSession(){this.sessionSrv.getActive().subscribe({next:n=>{let o=new Date(n.date_debut_entretien),c=new Date(n.date_fin_entretien);this.datesOfEntretiens=this.commonService.genererDates(o.getTime(),c.getTime()),this.indexCurrentDate=0,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate]}})}handleInterviewerSelect(n){this.getEntretiens()}getEntretiens(){this.noteService.liste().subscribe({next:n=>{let o=n.filter(a=>{var h,C;return new Date(a.debut_entretien).getDate()===this.currentDate.getDate()&&(null===(h=a.compte)||void 0===h?void 0:h.name)+" "+(null===(C=a.compte)||void 0===C?void 0:C.prenom)===this.interviewer});o.sort((a,h)=>new Date(a.fin_entretien).getTime()-new Date(h.fin_entretien).getTime());let c=o.map(a=>{var h,C,Z;return{centre:(null===(h=a.candidature)||void 0===h?void 0:h.centre)||"",interviewer:(null===(C=a.compte)||void 0===C?void 0:C.name)+" "+(null===(Z=a.compte)||void 0===Z?void 0:Z.prenom),candidat:a.candidature,disponibility:{date_disponibilite:a.debut_entretien,debut_disponibilite:new Date(a.debut_entretien),fin_disponibilite:new Date(a.fin_entretien)}}});this.entretiensBeforeBreak=c.filter(a=>a.disponibility.fin_disponibilite.getHours()<=12),this.entretiensAfterBreak=c.filter(a=>a.disponibility.fin_disponibilite.getHours()>12)},error:n=>{console.log("error: ",n)}})}prochaineDate(){this.indexCurrentDate<this.datesOfEntretiens.length&&(this.indexCurrentDate=this.indexCurrentDate>this.datesOfEntretiens.length?this.datesOfEntretiens.length-1:this.indexCurrentDate+1,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate],this.getEntretiens())}previousDate(){this.indexCurrentDate>0&&(this.indexCurrentDate=this.indexCurrentDate<0?0:this.indexCurrentDate-1,this.currentDate=this.datesOfEntretiens[this.indexCurrentDate],this.getEntretiens())}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(v.Y),e.Y36(p.R),e.Y36(f.v),e.Y36(r.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-calendrier-entretien"]],decls:39,vars:8,consts:[[1,"calendrier-entretien-page","calendrier-page","page-content"],[1,"page-title"],[1,"pi","pi-angle-right"],[1,"card"],[1,"header"],[1,"title"],["placeholder","Choisir un intervenant",3,"options","showClear","ngModel","onChange","ngModelChange"],["class","btn btn-danger ml-1 mr-1",3,"click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"line"],[1,"sub-header"],["class","title",4,"ngIf"],[1,"calendrier"],["id","table"],[4,"ngFor","ngForOf"],["colspan","4",1,"pause"],[1,"btn","btn-danger","ml-1","mr-1",3,"click"],[1,"btn","btn-primary",3,"click"],["class","rowspan",4,"ngIf"],[1,"rowspan"]],template:function(n,o){1&n&&(e.TgZ(0,"section",0)(1,"h1",1),e._uU(2," Entretiens "),e._UZ(3,"i",2),e._uU(4," Calendrier des entretiens"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"h3",5),e._uU(8,"Calendrier final des entretiens"),e.qZA(),e.TgZ(9,"div")(10,"p-dropdown",6),e.NdJ("onChange",function(a){return o.handleInterviewerSelect(a)})("ngModelChange",function(a){return o.interviewer=a}),e.qZA(),e.YNc(11,u,2,0,"button",7),e.YNc(12,g,2,0,"button",8),e.qZA()(),e._UZ(13,"div",9),e.TgZ(14,"div",10)(15,"h3",5),e._uU(16,"Entretiens concours Ucac-Icam"),e.qZA(),e.YNc(17,D,3,3,"h3",11),e.qZA(),e.TgZ(18,"div",12)(19,"table",13)(20,"thead")(21,"th"),e._uU(22,"Horaire"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Centre d'examen"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Noms"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Pr\xe9nom"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Intervenants"),e.qZA()(),e.TgZ(31,"tbody"),e.YNc(32,A,12,11,"tr",14),e.TgZ(33,"tr")(34,"td"),e._uU(35,"12h00 - 13h00"),e.qZA(),e.TgZ(36,"td",15),e._uU(37,"Pause"),e.qZA()(),e.YNc(38,M,12,11,"tr",14),e.qZA()()()()()),2&n&&(e.xp6(10),e.Q6J("options",o.interviewers)("showClear",!0)("ngModel",o.interviewer),e.xp6(1),e.Q6J("ngIf",o.datesOfEntretiens.length>1),e.xp6(1),e.Q6J("ngIf",o.datesOfEntretiens.length>1),e.xp6(5),e.Q6J("ngIf",o.currentDate),e.xp6(15),e.Q6J("ngForOf",o.entretiensBeforeBreak),e.xp6(6),e.Q6J("ngForOf",o.entretiensAfterBreak))},directives:[l.Lt,t.JJ,t.On,m.O5,m.sg],pipes:[m.uU],encapsulation:2}),i})();var U=s(7671),b=s(7618);const w=[{path:"",component:O,canActivate:[b.a]},{path:"**",component:O,canActivate:[b.a]}];let I=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[b.a],imports:[[U.Bz.forChild(w)],U.Bz]}),i})(),S=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[m.ez,I,t.u5,t.UX,l.kW]]}),i})()},7921:(T,_,s)=>{s.d(_,{K:()=>f});var m=s(2340),e=s(7587),v=s(520),p=s(4920);let f=(()=>{class r{constructor(t,u){this.http=t,this.baseUrlSvr=u,this.url="",this.url=`${this.baseUrlSvr.getOrigin()}${m.N.administrationPath}`,this.url+="session/"}liste(){return this.http.get(this.url+"all")}getOne(t){return this.http.get(this.url+t)}getActive(){return this.http.get(this.url+"active")}getNext(){return this.http.get(this.url+"next")}create(t){return this.http.post(this.url+"create",t)}update(t){return this.http.patch(this.url+(null==t?void 0:t.id),t)}updateForEntretien(t){return this.http.patch(this.url+"date_entretiens/"+(null==t?void 0:t.id),t)}delete(t){return this.http.delete(this.url+t)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(v.eN),e.LFG(p.x))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},62:(T,_,s)=>{s.d(_,{v:()=>v});var m=s(9808),e=s(7587);let v=(()=>{class p{constructor(){}calculerJours(r,l){var t=Math.abs(l-r);return Math.floor(t/864e5)}genererDates(r,l){let t=this.calculerJours(r,l);console.log("nombre jour:",t);let u=[],g=new Date(r);u.push(new Date(r));for(let D=0;D<t;D++)g.setDate(g.getDate()+1),u.push(new Date(g));return u}formatDate(r){let t=(0,m.p6)(r,"shortTime","fr-FR").split(":");return t[0]+"h"+t[1]}buildDateWithTime(r){const l=new Date;return new Date(`${l.getFullYear()}-${l.getMonth()+1}-${l.getDate()} ${r}`)}buildDate(r,l){let u,g,t=l.split("-"),E=t[0].split("h");r.setHours(parseInt(E[0],10)),r.setMinutes(parseInt(E[1],10)),u=r.getTime();let x=t[1].split("h");return r.setHours(parseInt(x[0],10)),r.setMinutes(parseInt(x[1],10)),g=r.getTime(),{startDate:u,endDate:g}}}return p.\u0275fac=function(r){return new(r||p)},p.\u0275prov=e.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},7212:(T,_,s)=>{s.d(_,{R:()=>f});var m=s(2340),e=s(7587),v=s(520),p=s(4920);let f=(()=>{class r{constructor(t,u){this.http=t,this.baseUrlSvr=u,this.url="",this.url=`${this.baseUrlSvr.getOrigin()}${m.N.interviewPath}`,this.url+="comptedisponibilite/"}liste(){return this.http.get(this.url+"all")}allBySession(t){return this.http.get(this.url+"bysession/"+t)}getOne(t){return this.http.get(this.url+t)}create(t){return this.http.post(this.url+"create",t)}update(t){return this.http.patch(this.url+(null==t?void 0:t.id),t)}delete(t){return this.http.delete(this.url+t)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(v.eN),e.LFG(p.x))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);