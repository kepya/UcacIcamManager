"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[443],{8443:(F,f,l)=>{l.r(f),l.d(f,{GestionSolvableModule:()=>k});var p=l(9808),_=l(7671),h=l(5193),e=l(7587),Z=l(9930),b=l(3270),T=l(2042),y=l(3149),x=l(5119),A=l(7755),v=l(9783),d=l(2382),S=l(7773),C=l(7307);function O(s,a){if(1&s&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&s){const n=a.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.nom)}}function z(s,a){if(1&s){const n=e.EpF();e.TgZ(0,"select",39),e.NdJ("change",function(i){return e.CHM(n),e.oxw().handleZoneSelect(i)}),e.TgZ(1,"option",40),e._uU(2,"Select zones"),e.qZA(),e.YNc(3,O,2,2,"option",41),e.qZA()}if(2&s){const n=e.oxw();e.xp6(3),e.Q6J("ngForOf",n.zones)}}function U(s,a){if(1&s&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&s){const n=a.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.nom)}}function G(s,a){if(1&s){const n=e.EpF();e.TgZ(0,"select",39),e.NdJ("change",function(i){return e.CHM(n),e.oxw().handleSiteSelect(i)}),e.YNc(1,U,2,2,"option",41),e.qZA()}if(2&s){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.sites)}}function J(s,a){if(1&s&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&s){const n=a.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.nom)}}function q(s,a){if(1&s){const n=e.EpF();e.TgZ(0,"select",39),e.NdJ("change",function(i){return e.CHM(n),e.oxw().handleCentreSelect(i)}),e.YNc(1,J,2,2,"option",41),e.qZA()}if(2&s){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.centres)}}function B(s,a){if(1&s){const n=e.EpF();e.TgZ(0,"i",42),e.NdJ("click",function(){return e.CHM(n),e.oxw().searchValue=""}),e.qZA()}}function M(s,a){if(1&s){const n=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",43),e.NdJ("change",function(i){const r=e.CHM(n).$implicit;return e.oxw().validateSolvabilityOfCandidats(i,r)}),e.qZA()(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA()()}if(2&s){const n=a.$implicit;e.xp6(4),e.Oqu(null==n?null:n.code_examen),e.xp6(2),e.Oqu(null==n?null:n.cycle),e.xp6(2),e.Oqu(null==n?null:n.centre),e.xp6(2),e.lnq("",null==n?null:n.formation1,", ",n.formation2,", ",n.formation3,""),e.xp6(2),e.Oqu(null==n?null:n.statut)}}function N(s,a){1&s&&(e.TgZ(0,"tr")(1,"td",44)(2,"span",45),e._uU(3," Aucune candidatures trouv\xe9s avec ces lettres dans son nom "),e.qZA()()())}function I(s,a){1&s&&(e.TgZ(0,"tr")(1,"td",44)(2,"span",45),e._uU(3," Aucune candidatures presents dans la base "),e.qZA()()())}function P(s,a){if(1&s){const n=e.EpF();e.TgZ(0,"li",46)(1,"a",47),e.NdJ("click",function(){return e.CHM(n),e.oxw().previous()}),e._uU(2,"Pr\xe9cedent"),e.qZA()()}}function E(s,a){if(1&s){const n=e.EpF();e.TgZ(0,"li",48)(1,"a",49),e.NdJ("click",function(){return e.CHM(n),e.oxw().next()}),e._uU(2,"Suivant"),e.qZA()()}}const u=function(s){return{bold:s}},w=[{path:"",component:(()=>{class s{constructor(n,t,i,o,r,c,g,m){this.candidatureSrv=n,this.storageService=t,this.siteSrv=i,this.exportExcelService=o,this.centreSrv=r,this.zoneService=c,this.messageService=g,this.confirmationService=m,this.candidatures=[],this.candidatsSolvable=[],this.searchCandidatures=[],this.loading=!1,this.zones=[],this.sites=[],this.centres=[]}ngOnInit(){this.sortProperty="code_examen",this.sortIcon="fa-solid fa-arrow-down-short-wide",this.downUpIcon="pi pi-sort-alt",this.pageSize=10,this.page=1,this.compte=this.storageService.getUserConnected(),this.getZonesOfUser()}sort(n,t=this.candidatures){return this.sortProperty=n,this.isAsc=!this.isAsc,this.sortIcon=this.isAsc?"fa-solid fa-arrow-down-short-wide":"fa-solid fa-arrow-down-wide-short","nom"===n&&t.sort(this.isAsc?(i,o)=>i.compte.name>o.compte.name?1:o.compte.name>i.compte.name?-1:0:(i,o)=>i.compte.name>o.compte.name?-1:o.compte.name>i.compte.name?1:0),"prenom"===n&&t.sort(this.isAsc?(i,o)=>i.compte.prenom>o.compte.prenom?1:o.compte.prenom>i.compte.prenom?-1:0:(i,o)=>i.compte.prenom>o.compte.prenom?-1:o.compte.prenom>i.compte.prenom?1:0),"statut"===n&&t.sort(this.isAsc?(i,o)=>i.statut>o.statut?1:o.statut>i.statut?-1:0:(i,o)=>i.statut>o.statut?-1:o.statut>i.statut?1:0),"nationalite"===n&&t.sort(this.isAsc?(i,o)=>i.nationalite>o.nationalite?1:o.nationalite>i.nationalite?-1:0:(i,o)=>i.nationalite>o.nationalite?-1:o.nationalite>i.nationalite?1:0),"photo"===n&&t.sort(this.isAsc?(i,o)=>i.image>o.image?1:o.image>i.image?-1:0:(i,o)=>i.image>o.image?-1:o.image>i.image?1:0),t}exportToExcel(){this.loading=!0,this.exportExcelService.downloadCandidatureExcel().subscribe(n=>{const t=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=window.URL.createObjectURL(t),o=document.createElement("a");o.href=i,o.download="data.xlsx",o.click(),window.URL.revokeObjectURL(i),this.loading=!1})}handlePageSize(n){var t,i,o;"centre"==this.actifOption&&this.getCandidaturesByCentre(null!==(t=this.centre.id)&&void 0!==t?t:0),"site"==this.actifOption&&this.getCandidaturesBySite(null!==(i=this.site.id)&&void 0!==i?i:0),"zone"==this.actifOption&&this.getCandidaturesByZone(null!==(o=this.zone.id)&&void 0!==o?o:0)}handleCategorieSelect(n){this.compte.role==h.u.SUPER_ADMIN&&("centre"==n.target.value&&this.getCentres(),"site"==n.target.value&&this.getSites())}handleZoneSelect(n){var t;this.zone=this.zones.find(i=>i.id==n.target.value),this.getCandidaturesByZone(null!==(t=n.target.value)&&void 0!==t?t:0)}handleCentreSelect(n){var t;this.centre=this.centres.find(i=>i.id==n.target.value),this.getCandidaturesByCentre(null!==(t=n.target.value)&&void 0!==t?t:0)}handleSiteSelect(n){var t;this.site=this.sites.find(i=>i.id==n.target.value),this.getCandidaturesBySite(null!==(t=n.target.value)&&void 0!==t?t:0)}handleSearchValue(n){if(this.searchValue=n.target.value,""!==this.searchValue){let i=this.searchCandidatures.map(o=>o.compte.name).filter(o=>o.toLowerCase().indexOf(this.searchValue.toLowerCase()+"")>-1);if(0===i.length)this.candidatures=[];else{let o=[];for(let r=0;r<i.length;r++){const c=i[r];let g=this.searchCandidatures.filter(m=>m.compte.name.indexOf(""+c)>-1);o.push(...g)}this.candidatures=o}}else this.candidatures=this.searchCandidatures}next(){var n,t,i;this.page++,"centre"==this.actifOption&&this.getCandidaturesByCentre(null!==(n=this.centre.id)&&void 0!==n?n:0),"site"==this.actifOption&&this.getCandidaturesBySite(null!==(t=this.site.id)&&void 0!==t?t:0),"zone"==this.actifOption&&this.getCandidaturesByZone(null!==(i=this.zone.id)&&void 0!==i?i:0)}previous(){var n,t,i;this.page--,"centre"==this.actifOption&&this.getCandidaturesByCentre(null!==(n=this.centre.id)&&void 0!==n?n:0),"site"==this.actifOption&&this.getCandidaturesBySite(null!==(t=this.site.id)&&void 0!==t?t:0),"zone"==this.actifOption&&this.getCandidaturesByZone(null!==(i=this.zone.id)&&void 0!==i?i:0)}getCandidaturesByZone(n){this.actifOption="zone",this.candidatureSrv.allSolvableByZone(n,!1).subscribe({next:t=>{t=this.sort("nom",t),this.searchCandidatures=[],this.searchCandidatures=t,this.candidatures=t.map((i,o)=>Object.assign({id:o+1},i)).slice((this.page-1)*this.pageSize,(this.page-1)*this.pageSize+this.pageSize),this.collectionSize=t.length,this.nbrOfPage=Math.ceil(t.length/this.pageSize)},error:t=>{console.log("error: ",t)}})}getCandidaturesByCentre(n){this.actifOption="centre",this.candidatureSrv.allSolvableByCentre(n,!1).subscribe({next:t=>{t=this.sort("nom",t),this.searchCandidatures=[],this.searchCandidatures=t,this.candidatures=t.map((i,o)=>Object.assign({id:o+1},i)).slice((this.page-1)*this.pageSize,(this.page-1)*this.pageSize+this.pageSize),this.collectionSize=t.length,this.nbrOfPage=Math.ceil(t.length/this.pageSize)},error:t=>{console.log("error: ",t)}})}getCandidaturesBySite(n){this.actifOption="site",this.candidatureSrv.allSolvableBySite(n,!1).subscribe({next:t=>{t=this.sort("nom",t),this.searchCandidatures=[],this.searchCandidatures=t,this.candidatures=t.map((i,o)=>Object.assign({id:o+1},i)).slice((this.page-1)*this.pageSize,(this.page-1)*this.pageSize+this.pageSize),this.collectionSize=t.length,this.nbrOfPage=Math.ceil(t.length/this.pageSize)},error:t=>{console.log("error: ",t)}})}getZonesOfUser(){var n;this.compte.role==h.u.SUPER_ADMIN&&this.zoneService.liste().subscribe({next:t=>{var i,o,r;this.zone=t[0],this.zones=t,this.getCandidaturesByZone(null!==(i=this.zone.id)&&void 0!==i?i:0),this.getSitesByZone(null!==(o=this.zone.id)&&void 0!==o?o:0),this.getCentreByZone(null!==(r=this.zone.id)&&void 0!==r?r:0)},error:t=>{console.log("error: ",t)}}),(this.compte.role==h.u.ADMIN||this.compte.role==h.u.JURY)&&this.zoneService.getOne(null!==(n=this.compte.idZone)&&void 0!==n?n:0).subscribe({next:t=>{var i,o,r;this.zone=t,this.zones=[t],this.getCandidaturesByZone(null!==(i=t.id)&&void 0!==i?i:0),this.getSitesByZone(null!==(o=t.id)&&void 0!==o?o:0),this.getCentreByZone(null!==(r=t.id)&&void 0!==r?r:0)},error:t=>{console.log("error: ",t)}})}getCentreByZone(n){this.centreSrv.allByZone(n).subscribe({next:t=>{this.centres=t},error:t=>{console.log("error: ",t)}})}getSitesByZone(n){this.siteSrv.allByZone(n).subscribe({next:t=>{this.sites=t},error:t=>{console.log("error: ",t)}})}getCentres(){this.centreSrv.liste().subscribe({next:n=>{this.centres=n},error:n=>{console.log("error: ",n)}})}getSites(){this.siteSrv.liste().subscribe({next:n=>{this.sites=n},error:n=>{console.log("error: ",n)}})}validateSolvabilityOfCandidats(n,t){if(n.target.checked)this.candidatsSolvable.push(t);else{let i=this.candidatsSolvable.findIndex(o=>o.id==t.id);i>-1&&this.candidatsSolvable.splice(i)}}validateSolvabilityCandidats(){for(let n=0;n<this.candidatsSolvable.length;n++){const t=this.candidatsSolvable[n];t.solvable=!0,this.candidatureSrv.update(t.id||0,t).subscribe({next:i=>{var o,r,c;this.messageService.add({severity:"success",summary:"Candidature pass\xe9 \xe0 solvable",detail:"Le candidat "+t.compte.name+" est desormais solvable et peut participer au concours."}),"centre"==this.actifOption&&this.getCandidaturesByCentre(null!==(o=this.centre.id)&&void 0!==o?o:0),"site"==this.actifOption&&this.getCandidaturesBySite(null!==(r=this.site.id)&&void 0!==r?r:0),"zone"==this.actifOption&&this.getCandidaturesByZone(null!==(c=this.zone.id)&&void 0!==c?c:0)},error:i=>{console.log("error: ",i)}})}}confirm(n){this.confirmationService.confirm({target:n.target,message:"\xcates vous sures de vouloir continuer ?",icon:"pi pi-question",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>{this.validateSolvabilityCandidats()},reject:()=>{this.messageService.add({severity:"error",summary:"Non",detail:"vous avez annul\xe9 la validation"})}})}}return s.\u0275fac=function(n){return new(n||s)(e.Y36(Z.u),e.Y36(b.V),e.Y36(T.P),e.Y36(y.O),e.Y36(x.T),e.Y36(A.b),e.Y36(v.ez),e.Y36(v.YP))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-gestion-solvable"]],decls:90,vars:45,consts:[[1,"Candidature-page","page-content"],[1,"page-title"],[1,"pi","pi-angle-right"],[1,"card"],[1,"header"],[1,"title"],[1,"btn","btn-primary",3,"click"],[1,"line"],[1,"table-content"],[1,"search-content"],[1,"select-page-size"],["name","page-size","id","page-size",3,"ngModel","change","ngModelChange"],["value","10"],["value","25"],["value","50"],["value","100"],[1,"search"],[1,"select-item"],[1,"label"],[1,"form","form-control",3,"ngModel","ngModelChange","change"],["value","centre"],["value","site"],["value","zone"],["class","form form-control",3,"change",4,"ngIf"],[1,"search_value"],["type","text","name","value","id","value",3,"ngModel","ngModelChange","keyup"],["class","fa fa-close pull-right",3,"click",4,"ngIf"],[1,"row"],["id","table"],[3,"ngClass","click"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"pagination_content"],[1,"pagination"],["class","paginate_button previous disabled","id","datatable-responsive_previous",4,"ngIf"],[1,"paginate_button","active"],["aria-controls","datatable-responsive","data-dt-idx","1","tabindex","0"],["class","paginate_button next disabled","id","datatable-responsive_next",4,"ngIf"],[1,"card","flex","justify-content-center","gap-2"],[1,"form","form-control",3,"change"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"fa","fa-close","pull-right",3,"click"],["type","checkbox","name","validate",1,"checkbox",3,"change"],["colspan","9"],[1,"vh-center"],["id","datatable-responsive_previous",1,"paginate_button","previous","disabled"],["aria-controls","datatable-responsive","data-dt-idx","0","tabindex","0",3,"click"],["id","datatable-responsive_next",1,"paginate_button","next","disabled"],["aria-controls","datatable-responsive","data-dt-idx","2","tabindex","0",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"section",0)(1,"h1",1),e._uU(2," Candidatures "),e._UZ(3,"i",2),e._uU(4," Gestion de la solvabilit\xe9"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"h3",5),e._uU(8,"Liste des candidatures n'ayant pas encore pay\xe9"),e.qZA(),e.TgZ(9,"div")(10,"button",6),e.NdJ("click",function(o){return t.confirm(o)}),e._uU(11," valider "),e.qZA()()(),e._UZ(12,"div",7),e.TgZ(13,"div",8)(14,"div",9)(15,"div",10)(16,"span"),e._uU(17,"Voir"),e.qZA(),e.TgZ(18,"select",11),e.NdJ("change",function(o){return t.handlePageSize(o)})("ngModelChange",function(o){return t.pageSize=o}),e.TgZ(19,"option",12),e._uU(20,"10"),e.qZA(),e.TgZ(21,"option",13),e._uU(22,"25"),e.qZA(),e.TgZ(23,"option",14),e._uU(24,"50"),e.qZA(),e.TgZ(25,"option",15),e._uU(26,"100"),e.qZA()(),e.TgZ(27,"span"),e._uU(28,"entr\xe9es"),e.qZA()(),e.TgZ(29,"div",16)(30,"div",17)(31,"span",18),e._uU(32,"Categories"),e.qZA(),e.TgZ(33,"select",19),e.NdJ("ngModelChange",function(o){return t.searchOption=o})("change",function(o){return t.handleCategorieSelect(o)}),e.TgZ(34,"option",20),e._uU(35,"Centre"),e.qZA(),e.TgZ(36,"option",21),e._uU(37,"Site"),e.qZA(),e.TgZ(38,"option",22),e._uU(39,"Zone"),e.qZA()(),e.YNc(40,z,4,1,"select",23),e.YNc(41,G,2,1,"select",23),e.YNc(42,q,2,1,"select",23),e.qZA(),e.TgZ(43,"div",24)(44,"span"),e._uU(45,"Rechercher"),e.qZA(),e.TgZ(46,"div")(47,"input",25),e.NdJ("ngModelChange",function(o){return t.searchValue=o})("keyup",function(o){return t.handleSearchValue(o)}),e.qZA(),e.YNc(48,B,1,0,"i",26),e.qZA()()()(),e.TgZ(49,"div",27)(50,"table",28)(51,"tr")(52,"th")(53,"div"),e._uU(54," D\xe9cision de la solvabilit\xe9 "),e.qZA()(),e.TgZ(55,"th")(56,"div"),e._uU(57," Code d'examen "),e.TgZ(58,"i",29),e.NdJ("click",function(){return t.sort("code_examen")}),e.qZA()()(),e.TgZ(59,"th")(60,"div"),e._uU(61," Cycle "),e.TgZ(62,"i",29),e.NdJ("click",function(){return t.sort("cycle")}),e.qZA()()(),e.TgZ(63,"th")(64,"div"),e._uU(65," Centre d'examen "),e.TgZ(66,"i",29),e.NdJ("click",function(){return t.sort("centre")}),e.qZA()()(),e.TgZ(67,"th")(68,"div"),e._uU(69," Formations "),e.TgZ(70,"i",29),e.NdJ("click",function(){return t.sort("formation")}),e.qZA()()(),e.TgZ(71,"th")(72,"div"),e._uU(73," Etat "),e.TgZ(74,"i",29),e.NdJ("click",function(){return t.sort("statut")}),e.qZA()()()(),e.YNc(75,M,13,7,"tr",30),e.YNc(76,N,4,0,"tr",31),e.YNc(77,I,4,0,"tr",31),e.qZA()(),e.TgZ(78,"div",32)(79,"span"),e._uU(80),e.qZA(),e.TgZ(81,"ul",33),e.YNc(82,P,3,0,"li",34),e.TgZ(83,"li",35)(84,"a",36),e._uU(85,"1"),e.qZA()(),e.YNc(86,E,3,0,"li",37),e.qZA()()()(),e.TgZ(87,"div",38),e._UZ(88,"p-toast")(89,"p-confirmPopup"),e.qZA()()),2&n&&(e.xp6(18),e.Q6J("ngModel",t.pageSize),e.xp6(15),e.Q6J("ngModel",t.searchOption),e.xp6(7),e.Q6J("ngIf",t.searchOption&&"zone"==t.searchOption),e.xp6(1),e.Q6J("ngIf",t.searchOption&&"site"==t.searchOption),e.xp6(1),e.Q6J("ngIf",t.searchOption&&"centre"==t.searchOption),e.xp6(5),e.Q6J("ngModel",t.searchValue),e.xp6(1),e.Q6J("ngIf",t.searchValue),e.xp6(10),e.Gre("icon-sort ","code_examen"==t.sortProperty?t.sortIcon:t.downUpIcon,""),e.Q6J("ngClass",e.VKq(35,u,"code_examen"==t.sortProperty)),e.xp6(4),e.Gre("icon-sort ","cycle"==t.sortProperty?t.sortIcon:t.downUpIcon,""),e.Q6J("ngClass",e.VKq(37,u,"cycle"==t.sortProperty)),e.xp6(4),e.Gre("icon-sort ","centre"==t.sortProperty?t.sortIcon:t.downUpIcon,""),e.Q6J("ngClass",e.VKq(39,u,"centre"==t.sortProperty)),e.xp6(4),e.Gre("icon-sort ","formation"==t.sortProperty?t.sortIcon:t.downUpIcon,""),e.Q6J("ngClass",e.VKq(41,u,"formation"==t.sortProperty)),e.xp6(4),e.Gre("icon-sort ","statut"==t.sortProperty?t.sortIcon:t.downUpIcon,""),e.Q6J("ngClass",e.VKq(43,u,"statut"==t.sortProperty)),e.xp6(1),e.Q6J("ngForOf",t.candidatures),e.xp6(1),e.Q6J("ngIf",t.searchValue&&0===t.candidatures.length),e.xp6(1),e.Q6J("ngIf",!t.searchValue&&0===t.candidatures.length),e.xp6(3),e.lnq("Page ",t.page," sur ",t.nbrOfPage,", avec ",t.candidatures.length," entr\xe9es affich\xe9es"),e.xp6(2),e.Q6J("ngIf",t.page>1),e.xp6(4),e.Q6J("ngIf",t.page<t.nbrOfPage))},directives:[d.EJ,d.JJ,d.On,d.YN,d.Kr,p.O5,p.sg,d.Fj,p.mk,S.FN,C.P],encapsulation:2}),s})()}];let Q=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[_.Bz.forChild(w)],_.Bz]}),s})();var Y=l(845);let k=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[p.ez,Q,d.u5,S.EV,C.n,Y.hJ]]}),s})()}}]);