"use strict";(self.webpackChunkadmin_ucac_dashboard=self.webpackChunkadmin_ucac_dashboard||[]).push([[910],{1910:($,m,a)=>{a.r(m),a.d(m,{GestionEpreuveModule:()=>j});var l=a(9808),f=a(5861),p=a(5193),u=a(2382);class d{}var e=a(7587),x=a(2340),E=a(520),Z=a(4920);let T=(()=>{class i{constructor(t,n){this.http=t,this.baseUrlSvr=n,this.url="",this.url=`${this.baseUrlSvr.getOrigin()}${x.N.candidaturePath}`,this.url+="epreuve/"}liste(){return this.http.get(this.url+"all")}getOne(t){return this.http.get(this.url+t)}create(t,n){let r=new FormData;return r.append("file",n),r.append("matiereId",t.matiereId+""),r.append("sessionId",t.sessionId+""),this.http.post(this.url+"create",r)}update(t){return this.http.patch(this.url+(null==t?void 0:t.id),t)}delete(t){return this.http.delete(this.url+t)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(E.eN),e.LFG(Z.x))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var A=a(1242),C=a(7921),U=a(1303),b=a(9783);function I(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"button",29),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).showUpdateEpreuveView(s)}),e.TgZ(9,"div"),e._UZ(10,"i",30),e.qZA(),e.TgZ(11,"span"),e._uU(12," Modifier "),e.qZA()(),e.TgZ(13,"button",31),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).deleteEpreuve(s.id||0)}),e.TgZ(14,"div"),e._UZ(15,"i",32),e.qZA(),e.TgZ(16,"span"),e._uU(17," Supprimer "),e.qZA()()()()}if(2&i){const t=o.$implicit;e.xp6(2),e.Oqu(null==t||null==t.session?null:t.session.nom),e.xp6(2),e.Oqu(null==t||null==t.matiere?null:t.matiere.intitule),e.xp6(2),e.Oqu(null==t?null:t.path)}}function q(i,o){1&i&&(e.TgZ(0,"tr")(1,"td",33)(2,"span",34),e._uU(3," Aucune epreuve trouv\xe9es avec ces elements de recherche "),e.qZA()()())}function S(i,o){1&i&&(e.TgZ(0,"tr")(1,"td",33)(2,"span",34),e._uU(3," Aucune epreuve presentent dans la base "),e.qZA()()())}function G(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"li",35)(1,"a",36),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).previous()}),e._uU(2,"Pr\xe9cedent"),e.qZA()()}}function J(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"li",37)(1,"a",38),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).next()}),e._uU(2,"Suivant"),e.qZA()()}}const v=function(i){return{bold:i}};function w(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"section",2)(1,"h1",3),e._uU(2," Concours "),e._UZ(3,"i",4),e._uU(4," Epreuves concours"),e.qZA(),e.TgZ(5,"div",5)(6,"div",6)(7,"h3",7),e._uU(8,"Liste des epreuves"),e.qZA(),e.TgZ(9,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().viewEpreuve("add")}),e._uU(10," Ajouter une \xe9preuve "),e.qZA()(),e._UZ(11,"div",9),e.TgZ(12,"div",10)(13,"div",11)(14,"div",12)(15,"span"),e._uU(16,"Voir"),e.qZA(),e.TgZ(17,"select",13),e.NdJ("change",function(r){return e.CHM(t),e.oxw().handlePageSize(r)})("ngModelChange",function(r){return e.CHM(t),e.oxw().pageSize=r}),e.TgZ(18,"option",14),e._uU(19,"10"),e.qZA(),e.TgZ(20,"option",15),e._uU(21,"25"),e.qZA(),e.TgZ(22,"option",16),e._uU(23,"50"),e.qZA(),e.TgZ(24,"option",17),e._uU(25,"100"),e.qZA()(),e.TgZ(26,"span"),e._uU(27,"entr\xe9es"),e.qZA()()(),e.TgZ(28,"div",18)(29,"table",19)(30,"tr")(31,"th")(32,"div"),e._uU(33," Session "),e.TgZ(34,"i",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().sort("session")}),e.qZA()()(),e.TgZ(35,"th")(36,"div"),e._uU(37," Matiere "),e.TgZ(38,"i",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().sort("matiere")}),e.qZA()()(),e.TgZ(39,"th")(40,"div"),e._uU(41," Path "),e.TgZ(42,"i",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().sort("path")}),e.qZA()()(),e.TgZ(43,"th")(44,"div"),e._uU(45," # "),e.qZA()()(),e.YNc(46,I,18,3,"tr",21),e.YNc(47,q,4,0,"tr",22),e.YNc(48,S,4,0,"tr",22),e.qZA()(),e.TgZ(49,"div",23)(50,"span"),e._uU(51),e.qZA(),e.TgZ(52,"ul",24),e.YNc(53,G,3,0,"li",25),e.TgZ(54,"li",26)(55,"a",27),e._uU(56,"1"),e.qZA()(),e.YNc(57,J,3,0,"li",28),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(17),e.Q6J("ngModel",t.pageSize),e.xp6(17),e.Gre("icon-sort ","session"==t.sortProperty?t.sortIcon:t.downUpIcon,""),e.Q6J("ngClass",e.VKq(21,v,"session"==t.sortProperty)),e.xp6(4),e.Gre("icon-sort ","matiere"==t.sortProperty?t.sortIcon:t.downUpIcon,""),e.Q6J("ngClass",e.VKq(23,v,"matiere"==t.sortProperty)),e.xp6(4),e.Gre("icon-sort ","path"==t.sortProperty?t.sortIcon:t.downUpIcon,""),e.Q6J("ngClass",e.VKq(25,v,"path"==t.sortProperty)),e.xp6(4),e.Q6J("ngForOf",t.epreuves),e.xp6(1),e.Q6J("ngIf",t.searchValue&&0===t.epreuves.length),e.xp6(1),e.Q6J("ngIf",!t.searchValue&&0===t.epreuves.length),e.xp6(3),e.lnq("Page ",t.page," sur ",t.nbrOfPage,", avec ",t.epreuves.length," entr\xe9es affich\xe9es"),e.xp6(2),e.Q6J("ngIf",t.page>1),e.xp6(4),e.Q6J("ngIf",t.page<t.nbrOfPage)}}function M(i,o){if(1&i&&(e.TgZ(0,"option",55),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nom)}}function N(i,o){1&i&&(e.TgZ(0,"div"),e._uU(1," Veuillez s'il vous plait entrer une valeur "),e.qZA())}function F(i,o){if(1&i&&(e.TgZ(0,"div",56),e.YNc(1,N,2,0,"div",22),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formEpreuveControl.sessionId.errors.required)}}function y(i,o){if(1&i&&(e.TgZ(0,"option",55),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.intitule)}}function k(i,o){1&i&&(e.TgZ(0,"div"),e._uU(1," Veuillez s'il vous plait entrer une valeur "),e.qZA())}function O(i,o){if(1&i&&(e.TgZ(0,"div",56),e.YNc(1,k,2,0,"div",22),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formEpreuveControl.matiereId.errors.required)}}function Q(i,o){1&i&&(e.TgZ(0,"div"),e._uU(1," Veuillez s'il vous plait entrer le fichier "),e.qZA())}function Y(i,o){if(1&i&&(e.TgZ(0,"div",56),e.YNc(1,Q,2,0,"div",22),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formEpreuveControl.file.errors.required)}}const g=function(i){return{required:i}};function z(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"section",39)(1,"h1",3)(2,"img",40),e.NdJ("click",function(){return e.CHM(t),e.oxw().viewEpreuve()}),e.qZA(),e._uU(3," Epreuve d'examen "),e._UZ(4,"i",4),e._uU(5),e.qZA(),e.TgZ(6,"div",5)(7,"div",6)(8,"h3",7),e._uU(9),e.qZA()(),e._UZ(10,"div",9),e.TgZ(11,"form",41),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().createOrUpdateEpreuve()}),e.TgZ(12,"div",6),e._uU(13," Veullez remplir les champs suivants "),e._UZ(14,"div",9),e.qZA(),e.TgZ(15,"div",42)(16,"div",18)(17,"div",43)(18,"label",44),e._uU(19,"Session *"),e.qZA(),e.TgZ(20,"select",45)(21,"option",46),e._uU(22,"Session"),e.qZA(),e.YNc(23,M,2,2,"option",47),e.qZA()(),e.YNc(24,F,2,1,"div",48),e.qZA(),e.TgZ(25,"div",18)(26,"div",43)(27,"label",44),e._uU(28,"Mati\xe8re *"),e.qZA(),e.TgZ(29,"select",49)(30,"option",46),e._uU(31,"Mati\xe8re"),e.qZA(),e.YNc(32,y,2,2,"option",47),e.qZA()(),e.YNc(33,O,2,1,"div",48),e.qZA(),e.TgZ(34,"div",18)(35,"div",43)(36,"label",44),e._uU(37,"Fichier *"),e.qZA(),e.TgZ(38,"input",50),e.NdJ("change",function(r){return e.CHM(t),e.oxw().onFileChanged(r)}),e.qZA()(),e.YNc(39,Y,2,1,"div",48),e.qZA()(),e.TgZ(40,"div",51),e._UZ(41,"div",9),e.TgZ(42,"div",52)(43,"button",53),e.NdJ("click",function(){return e.CHM(t),e.oxw().createOrUpdateEpreuve()}),e._uU(44," Soumettre "),e.qZA(),e.TgZ(45,"button",54),e.NdJ("click",function(){return e.CHM(t),e.oxw().formEpreuve.reset()}),e._uU(46," Renitialiser "),e.qZA()()()()()()}if(2&i){const t=e.oxw();e.xp6(5),e.hij("",null!=t.epreuve&&t.epreuve.id?"Modifier":"Ajouter"," une epreuve"),e.xp6(4),e.hij("",null!=t.epreuve&&t.epreuve.id?"Modifier":"Ajouter"," une epreuve "),e.xp6(2),e.Q6J("formGroup",t.formEpreuve),e.xp6(9),e.Q6J("ngClass",e.VKq(11,g,t.formEpreuve.get("sessionId").invalid)),e.xp6(3),e.Q6J("ngForOf",t.sessions),e.xp6(1),e.Q6J("ngIf",t.formEpreuveControl.sessionId.errors),e.xp6(5),e.Q6J("ngClass",e.VKq(13,g,t.formEpreuve.get("matiereId").invalid)),e.xp6(3),e.Q6J("ngForOf",t.matters),e.xp6(1),e.Q6J("ngIf",t.formEpreuveControl.matiereId.errors),e.xp6(6),e.Q6J("ngIf",t.formEpreuveControl.file.errors),e.xp6(4),e.Q6J("disabled",t.formEpreuve.invalid)}}let P=(()=>{class i{constructor(t,n,r,s,_){this.epreuveService=t,this.matterService=n,this.sessionSrv=r,this.storageService=s,this.messageService=_,this.matters=[],this.sessions=[],this.epreuves=[],this.searchEpreuves=[],this.loading=!0,this.isJury=!1,this.isSuperAdmin=!1,this.isAdmin=!1,this.formEpreuve=new u.cw({sessionId:new u.NI(0,[u.kI.required,u.kI.min(1)]),matiereId:new u.NI(0,[u.kI.required,u.kI.min(1)]),file:new u.NI(null,[u.kI.required])}),this.convertBlobToBase64=B=>new Promise((R,K)=>{const c=new FileReader;c.onerror=K,c.onload=()=>{R(c.result)},c.readAsDataURL(B)})}get formEpreuveControl(){return this.formEpreuve.controls}ngOnInit(){this.sortProperty="horaire",this.sortIcon="fa-solid fa-arrow-down-short-wide",this.downUpIcon="pi pi-sort-alt",this.pageSize=10,this.page=1,this.compte=this.storageService.getUserConnected(),this.isJury=this.compte.role==p.u.JURY,this.isAdmin=this.compte.role==p.u.ADMIN,this.isSuperAdmin=this.compte.role==p.u.SUPER_ADMIN,this.getAllEpreuves(),this.getSessions(),this.getAllMatters()}handlePageSize(t){this.page=1,this.getAllEpreuves()}sort(t,n=this.epreuves){return this.sortProperty=t,this.isAsc=!this.isAsc,this.sortIcon=this.isAsc?"fa-solid fa-arrow-down-short-wide":"fa-solid fa-arrow-down-wide-short","matiere"===t&&n.sort(this.isAsc?(r,s)=>r.matiere.intitule>s.matiere.intitule?1:s.matiere.intitule>r.matiere.intitule?-1:0:(r,s)=>r.matiere.intitule>s.matiere.intitule?-1:s.matiere.intitule>r.matiere.intitule?1:0),"session"===t&&n.sort(this.isAsc?(r,s)=>r.session.nom>s.session.nom?1:s.session.nom>r.session.nom?-1:0:(r,s)=>r.session.nom>s.session.nom?-1:s.session.nom>r.session.nom?1:0),"path"===t&&n.sort(this.isAsc?(r,s)=>r.path>s.path?1:s.path>r.path?-1:0:(r,s)=>r.path>s.path?-1:s.path>r.path?1:0),n}viewEpreuve(t="data"){"data"===t?(this.epreuve=new d,this.isFormEpreuve=!1):this.isFormEpreuve=!0}getSessions(){this.sessionSrv.liste().subscribe({next:t=>{this.sessions=t},error:t=>{console.log("error: ",t)}})}showUpdateEpreuveView(t){this.epreuve=t,this.viewEpreuve("update")}createOrUpdateEpreuve(){var t;(null===(t=this.epreuve)||void 0===t?void 0:t.id)?(this.epreuve.matiereId=parseInt(this.formEpreuve.value.matiereId,10),this.epreuve.sessionId=parseInt(this.formEpreuve.value.sessionId,10),this.epreuveService.update(Object.assign({},this.epreuve)).subscribe({next:n=>{this.getAllEpreuves(),this.epreuve=new d,this.formEpreuve.reset(),this.isFormEpreuve=!1,this.messageService.add({severity:"success",summary:"Modification de l'epreuve",detail:"Modification de l'epreuve des \xe9valuations effectu\xe9e avec success"})},error:n=>{this.messageService.add({severity:"error",summary:"Erreur de modification",detail:n.message}),console.log("Error: ",n)}})):this.epreuveService.create(Object.assign(Object.assign({},this.formEpreuve.value),{file:this.selectedFile}),this.selectedFile).subscribe({next:n=>{this.getAllEpreuves(),this.epreuve=new d,this.formEpreuve.reset(),this.isFormEpreuve=!1,this.messageService.add({severity:"success",summary:"Cr\xe9ation de l'epreuve",detail:"Cr\xe9ation de l'epreuve des \xe9valuations effectu\xe9e avec success"})},error:n=>{this.messageService.add({severity:"error",summary:"Erreur de cr\xe9ation",detail:n.message}),console.log("Error: ",n)}})}onFileChanged(t){var n=this;return(0,f.Z)(function*(){n.uploadedFile=yield n.convertBlobToBase64(t.target.files[0]),n.selectedFile=t.target.files[0]})()}getAllEpreuves(){this.epreuveService.liste().subscribe({next:t=>{t=this.sort("intitule",t),this.searchEpreuves=[],this.searchEpreuves=t,this.epreuves=t.map((n,r)=>Object.assign({id:r+1},n)).slice((this.page-1)*this.pageSize,(this.page-1)*this.pageSize+this.pageSize),this.collectionSize=t.length,this.nbrOfPage=Math.ceil(t.length/this.pageSize)}})}getAllMatters(){this.matterService.liste().subscribe({next:t=>{this.matters=t}})}next(){this.page++,this.getAllEpreuves()}previous(){this.page--,this.getAllEpreuves()}deleteEpreuve(t){this.epreuveService.delete(t||0).subscribe({next:n=>{this.getAllEpreuves(),this.messageService.add({severity:"success",summary:"Suppression d'\xe9preuve",detail:"Suppression effectu\xe9e avec success"})},error:n=>{console.log("Error: ",n),this.messageService.add({severity:"error",summary:"Erreur de suppression",detail:n.message})}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(T),e.Y36(A.B),e.Y36(C.K),e.Y36(U.V),e.Y36(b.ez))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-gestion-epreuve"]],decls:3,vars:2,consts:[["class","note-page page-content",4,"ngIf","ngIfElse"],["addEpreuve",""],[1,"note-page","page-content"],[1,"page-title"],[1,"pi","pi-angle-right"],[1,"card"],[1,"header"],[1,"title"],[1,"btn","btn-danger","ml-1","mr-1",3,"click"],[1,"line"],[1,"table-content"],[1,"search-content"],[1,"select-page-size"],["name","page-size","id","page-size",3,"ngModel","change","ngModelChange"],["value","10"],["value","25"],["value","50"],["value","100"],[1,"row"],["id","table"],[3,"ngClass","click"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"pagination_content"],[1,"pagination"],["class","paginate_button previous disabled","id","datatable-responsive_previous",4,"ngIf"],[1,"paginate_button","active"],["aria-controls","datatable-responsive","data-dt-idx","1","tabindex","0"],["class","paginate_button next disabled","id","datatable-responsive_next",4,"ngIf"],[1,"btn",3,"click"],[1,"fa-solid","fa-pencil"],[1,"btn","mt-2",3,"click"],[1,"fa-solid","fa-trash"],["colspan","7"],[1,"vh-center"],["id","datatable-responsive_previous",1,"paginate_button","previous","disabled"],["aria-controls","datatable-responsive","data-dt-idx","0","tabindex","0",3,"click"],["id","datatable-responsive_next",1,"paginate_button","next","disabled"],["aria-controls","datatable-responsive","data-dt-idx","2","tabindex","0",3,"click"],[1,"Note-page","page-content"],["src","/assets/icons/undo-outline.svg","alt","","srcset","",1,"icon",3,"click"],[1,"form",3,"formGroup","ngSubmit"],[1,"main"],[1,"form-group"],["for",""],["formControlName","sessionId",3,"ngClass"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","alert",4,"ngIf"],["formControlName","matiereId",3,"ngClass"],["formControlName","file","type","file","id","file","required","","accept",".pdf, .doc, .xlsx, .docx","name","file",1,"form-control","form-control-lg",3,"change"],[1,"footer"],[1,"btn-group"],["type","button",1,"btn","btn-info",3,"disabled","click"],[1,"btn","btn-danger",3,"click"],[3,"value"],[1,"alert"]],template:function(t,n){if(1&t&&(e.YNc(0,w,58,27,"section",0),e.YNc(1,z,47,15,"ng-template",null,1,e.W1O)),2&t){const r=e.MAs(2);e.Q6J("ngIf",!n.isFormEpreuve)("ngIfElse",r)}},directives:[l.O5,u.EJ,u.JJ,u.On,u.YN,u.Kr,l.mk,l.sg,u._Y,u.JL,u.sg,u.u,u.Fj,u.Q7],encapsulation:2}),i})();var h=a(7671);const H=[{path:"",component:P}];let V=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[h.Bz.forChild(H)],h.Bz]}),i})(),j=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[l.ez,V,u.u5,u.UX]]}),i})()}}]);